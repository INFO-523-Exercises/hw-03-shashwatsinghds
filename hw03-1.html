<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Shashwat Singh">
<meta name="description" content="Classification: Basic Concepts and Techniques">

<title>hw03-01</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="hw03-1_files/libs/clipboard/clipboard.min.js"></script>
<script src="hw03-1_files/libs/quarto-html/quarto.js"></script>
<script src="hw03-1_files/libs/quarto-html/popper.min.js"></script>
<script src="hw03-1_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="hw03-1_files/libs/quarto-html/anchor.min.js"></script>
<link href="hw03-1_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="hw03-1_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="hw03-1_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="hw03-1_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="hw03-1_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">hw03-01</h1>
</div>

<div>
  <div class="description">
    Classification: Basic Concepts and Techniques
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Shashwat Singh </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="install-required-packages" class="level1">
<h1>Install Required Packages</h1>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Sets the number of significant figures to two</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">digits =</span> <span class="dv">3</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Checking and installing pacman </span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(pacman))</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"pacman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: pacman</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Downloads and load required packages</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidyverse, rpart, rpart.plot, caret, </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  lattice, FSelector, sampling, pROC, mlbench)</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Installed FSelector using the link provided in slack</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>Classification is a machine learning task with the goal to learn a predictive function of the form</p>
<p><strong>y=f(x)</strong></p>
<p>where is <strong>x</strong> called the attribute set and <strong>y</strong>, the class label. The attribute set consists of feature which describe an object. These features can be measured using any scale (i.e., nominal, interval, …). The class label is a nominal attribute. It it is a binary attribute, then the problem is called a binary classification problem.</p>
<p>Classification learns the classification model from training data where both the features and the correct class label are available. This is why it is called a supervised learning problem.</p>
<p>A related supervised learning problem is regression, where is a number instead of a label.</p>
<p>This chapter will introduce decision trees, model evaluation and comparison, feature selection, and then explore methods to handle the class imbalance problem.</p>
<ul>
<li>Load data and view</li>
<li>Examine columns and data types</li>
<li>Define box plots</li>
<li>Describe meta data</li>
</ul>
</section>
<section id="the-dataset" class="level1">
<h1>The Dataset</h1>
<p>Using the spam email dataset from tidyurl- The dataset classifies 4601 e-mails as spam or non-spam, with additional variables indicating the frequency of certain words and characters in the e-mail.</p>
<p>The features in the table are as</p>
<ul>
<li><p><strong>crl.tot -</strong> Total length of uninterrupted sequences of capitals</p></li>
<li><p><strong>dollar -</strong> Occurrences of the dollar sign, as percent of total number of characters</p></li>
<li><p><strong>bang -</strong> Occurrences of ‘!’, as percent of total number of characters</p></li>
<li><p><strong>money -</strong> Occurrences of ‘money’, as percent of total number of characters</p></li>
<li><p><strong>n000 -</strong> Occurrences of the string ‘000’, as percent of total number of words</p></li>
<li><p><strong>make -</strong> Occurrences of ‘make’, as a percent of total number of words</p></li>
<li><p><strong>yesno -</strong> Outcome variable, a factor with levels ‘n’ not spam, ‘y’ spam</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Loading the dataset</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>spam <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"/Users/shashwatsingh/Documents/GitHub/hw-03-shashwatsinghds/data/spam.csv"</span>) </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(spam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  crl.tot dollar  bang money n000 make yesno
1     278  0.000 0.778  0.00 0.00 0.00     y
2    1028  0.180 0.372  0.43 0.43 0.21     y
3    2259  0.184 0.276  0.06 1.16 0.06     y
4     191  0.000 0.137  0.00 0.00 0.00     y
5     191  0.000 0.135  0.00 0.00 0.00     y
6      54  0.000 0.000  0.00 0.00 0.00     y</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Properties of the data</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tibble</span>(spam, <span class="at">rownames =</span> <span class="st">"yesno"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4,601 × 8
   yesno crl.tot dollar  bang money  n000  make yesno
   &lt;chr&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;
 1 1         278  0     0.778  0     0     0    y    
 2 2        1028  0.18  0.372  0.43  0.43  0.21 y    
 3 3        2259  0.184 0.276  0.06  1.16  0.06 y    
 4 4         191  0     0.137  0     0     0    y    
 5 5         191  0     0.135  0     0     0    y    
 6 6          54  0     0      0     0     0    y    
 7 7         112  0.054 0.164  0     0     0    y    
 8 8          49  0     0      0     0     0    y    
 9 9        1257  0.203 0.181  0.15  0     0.15 y    
10 10        749  0.081 0.244  0     0.19  0.06 y    
# ℹ 4,591 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>spam <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.logical), factor, <span class="at">levels =</span> <span class="fu">c</span>(y, n))) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">where</span>(is.character), factor))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: There was 1 warning in `mutate()`.
ℹ In argument: `across(where(is.logical), factor, levels = c(y, n))`.
Caused by warning:
! The `...` argument of `across()` is deprecated as of dplyr 1.1.0.
Supply arguments directly to `.fns` through an anonymous function instead.

  # Previously
  across(a:b, mean, na.rm = TRUE)

  # Now
  across(a:b, \(x) mean(x, na.rm = TRUE))</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(spam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    crl.tot          dollar          bang          money            n000     
 Min.   :    1   Min.   :0.00   Min.   : 0.0   Min.   : 0.00   Min.   :0.00  
 1st Qu.:   35   1st Qu.:0.00   1st Qu.: 0.0   1st Qu.: 0.00   1st Qu.:0.00  
 Median :   95   Median :0.00   Median : 0.0   Median : 0.00   Median :0.00  
 Mean   :  283   Mean   :0.08   Mean   : 0.3   Mean   : 0.09   Mean   :0.10  
 3rd Qu.:  266   3rd Qu.:0.05   3rd Qu.: 0.3   3rd Qu.: 0.00   3rd Qu.:0.00  
 Max.   :15841   Max.   :6.00   Max.   :32.5   Max.   :12.50   Max.   :5.45  
      make      yesno   
 Min.   :0.00   n:2788  
 1st Qu.:0.00   y:1813  
 Median :0.00           
 Mean   :0.10           
 3rd Qu.:0.00           
 Max.   :4.54           </code></pre>
</div>
</div>
</section>
<section id="decision-trees" class="level1">
<h1>Decision Trees</h1>
<p>Recursive Partitioning (similar to CART) uses the Gini index to make splitting decisions and early stopping (pre-pruning).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="create-tree-with-default-settings-uses-pre-pruning" class="level3">
<h3 class="anchored" data-anchor-id="create-tree-with-default-settings-uses-pre-pruning">Create Tree With Default Settings (uses pre-pruning)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>tree_default <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>tree_default</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 4601 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

 1) root 4601 1810 n (0.606 0.394)  
   2) dollar&lt; 0.0555 3471  816 n (0.765 0.235)  
     4) bang&lt; 0.0915 2420  246 n (0.898 0.102) *
     5) bang&gt;=0.0915 1051  481 y (0.458 0.542)  
      10) crl.tot&lt; 85.5 535  175 n (0.673 0.327)  
        20) bang&lt; 0.774 418  106 n (0.746 0.254) *
        21) bang&gt;=0.774 117   48 y (0.410 0.590)  
          42) crl.tot&lt; 17 43   12 n (0.721 0.279) *
          43) crl.tot&gt;=17 74   17 y (0.230 0.770) *
      11) crl.tot&gt;=85.5 516  121 y (0.234 0.766) *
   3) dollar&gt;=0.0555 1130  133 y (0.118 0.882) *</code></pre>
</div>
</div>
<p><strong>Notes:</strong></p>
<ul>
<li><p><code>|&gt;</code> supplies the data for <code>rpart</code>. Since <code>data</code> is not the first argument of <code>rpart</code>, the syntax <code>data = _</code> is used to specify where the data in spam goes. The call is equivalent to <code>tree_default &lt;- rpart(yesno ~ ., data = spam)</code>.</p></li>
<li><p>The formula models the <code>type</code> variable by all other features is represented by <code>.</code>.</p></li>
<li><p>the class variable needs a factor (nominal) or rpart will create a regression tree instead of a decision tree. Use <code>as.factor()</code> if necessary</p></li>
</ul>
<p>Plotting</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_default, <span class="at">extra =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="create-a-full-tree" class="level3">
<h3 class="anchored" data-anchor-id="create-a-full-tree"><strong>Create a Full Tree</strong></h3>
<p>To create a full tree, we set the complexity parameter cp to 0 (split even if it does not improve the tree) and we set the minimum number of observations in a node needed to split to the smallest value of 2 (see: <code>?rpart.control</code>). <em>Note:</em> full trees overfit the training data!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>tree_full <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> </span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(yesno <span class="sc">~</span> . , <span class="at">data =</span> _, </span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> <span class="dv">0</span>))</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_full, <span class="at">extra =</span> <span class="dv">2</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>           <span class="at">roundint=</span><span class="cn">FALSE</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>           <span class="at">box.palette =</span> <span class="fu">list</span>( <span class="st">"Bu"</span>,<span class="st">"Or"</span>)</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>           )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: labs do not fit even at cex 0.15, there may be some overplotting</code></pre>
</div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>tree_full</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>n= 4601 

node), split, n, loss, yval, (yprob)
      * denotes terminal node

1.00e+00) root 4601 1810 n (0.60596 0.39404)  
  2.00e+00) dollar&lt; 0.0555 3471  816 n (0.76491 0.23509)  
    4.00e+00) bang&lt; 0.0915 2420  246 n (0.89835 0.10165)  
      8.00e+00) n000&lt; 0.26 2399  232 n (0.90329 0.09671)  
        1.60e+01) money&lt; 0.035 2351  213 n (0.90940 0.09060)  
          3.20e+01) crl.tot&lt; 29.5 809   31 n (0.96168 0.03832) *
          3.30e+01) crl.tot&gt;=29.5 1542  182 n (0.88197 0.11803)  
            6.60e+01) crl.tot&lt; 3.24e+03 1534  178 n (0.88396 0.11604)  
              1.32e+02) crl.tot&gt;=506 173    6 n (0.96532 0.03468)  
                2.64e+02) bang&lt; 0.0285 146    2 n (0.98630 0.01370)  
                  5.28e+02) dollar&lt; 0.05 142    1 n (0.99296 0.00704)  
                    1.06e+03) crl.tot&lt; 1.32e+03 109    0 n (1.00000 0.00000) *
                    1.06e+03) crl.tot&gt;=1.32e+03 33    1 n (0.96970 0.03030)  
                      2.11e+03) crl.tot&gt;=1.32e+03 32    0 n (1.00000 0.00000) *
                      2.12e+03) crl.tot&lt; 1.32e+03 1    0 y (0.00000 1.00000) *
                  5.29e+02) dollar&gt;=0.05 4    1 n (0.75000 0.25000) *
                2.65e+02) bang&gt;=0.0285 27    4 n (0.85185 0.14815)  
                  5.30e+02) bang&gt;=0.0345 20    1 n (0.95000 0.05000)  
                    1.06e+03) crl.tot&lt; 980 14    0 n (1.00000 0.00000) *
                    1.06e+03) crl.tot&gt;=980 6    1 n (0.83333 0.16667)  
                      2.12e+03) crl.tot&gt;=1.01e+03 5    0 n (1.00000 0.00000) *
                      2.12e+03) crl.tot&lt; 1.01e+03 1    0 y (0.00000 1.00000) *
                  5.31e+02) bang&lt; 0.0345 7    3 n (0.57143 0.42857)  
                    1.06e+03) make&gt;=0.07 3    0 n (1.00000 0.00000) *
                    1.06e+03) make&lt; 0.07 4    1 y (0.25000 0.75000)  
                      2.13e+03) crl.tot&gt;=2.76e+03 1    0 n (1.00000 0.00000) *
                      2.13e+03) crl.tot&lt; 2.76e+03 3    0 y (0.00000 1.00000) *
              1.33e+02) crl.tot&lt; 506 1361  172 n (0.87362 0.12638)  
                2.66e+02) dollar&lt; 0.039 1331  161 n (0.87904 0.12096)  
                  5.32e+02) crl.tot&lt; 502 1325  158 n (0.88075 0.11925)  
                    1.06e+03) crl.tot&lt; 98.5 698   68 n (0.90258 0.09742)  
                      2.13e+03) make&lt; 2.21 696   67 n (0.90374 0.09626)  
                        4.26e+03) make&gt;=0.58 44    0 n (1.00000 0.00000) *
                        4.26e+03) make&lt; 0.58 652   67 n (0.89724 0.10276)  
                          8.51e+03) make&lt; 0.5 646   65 n (0.89938 0.10062)  
                            1.70e+04) crl.tot&gt;=88.5 66    2 n (0.96970 0.03030) *
                            1.70e+04) crl.tot&lt; 88.5 580   63 n (0.89138 0.10862)  
                              3.41e+04) crl.tot&gt;=36.5 479   48 n (0.89979 0.10021)  
                                6.81e+04) crl.tot&lt; 48.5 160   11 n (0.93125 0.06875) *
                                6.81e+04) crl.tot&gt;=48.5 319   37 n (0.88401 0.11599)  
                                  1.36e+05) bang&lt; 0.058 304   33 n (0.89145 0.10855)  
                                    2.72e+05) crl.tot&gt;=51.5 273   27 n (0.90110 0.09890)  
                                      5.45e+05) crl.tot&lt; 60.5 74    4 n (0.94595 0.05405) *
                                      5.45e+05) crl.tot&gt;=60.5 199   23 n (0.88442 0.11558)  
                                        1.09e+06) crl.tot&gt;=62.5 180   18 n (0.90000 0.10000)  
                                          2.18e+06) crl.tot&lt; 65.5 24    0 n (1.00000 0.00000) *
                                          2.18e+06) crl.tot&gt;=65.5 156   18 n (0.88462 0.11538)  
                                            4.36e+06) crl.tot&gt;=66.5 152   16 n (0.89474 0.10526)  
                                              8.72e+06) make&lt; 0.32 144   14 n (0.90278 0.09722) *
                                              8.72e+06) make&gt;=0.32 8    2 n (0.75000 0.25000)  
                                                1.74e+07) crl.tot&gt;=70 6    0 n (1.00000 0.00000) *
                                                1.74e+07) crl.tot&lt; 70 2    0 y (0.00000 1.00000) *
                                            4.36e+06) crl.tot&lt; 66.5 4    2 n (0.50000 0.50000) *
                                        1.09e+06) crl.tot&lt; 62.5 19    5 n (0.73684 0.26316) *
                                    2.72e+05) crl.tot&lt; 51.5 31    6 n (0.80645 0.19355) *
                                  1.36e+05) bang&gt;=0.058 15    4 n (0.73333 0.26667)  
                                    2.72e+05) bang&gt;=0.0805 6    0 n (1.00000 0.00000) *
                                    2.72e+05) bang&lt; 0.0805 9    4 n (0.55556 0.44444)  
                                      5.45e+05) crl.tot&gt;=68 7    2 n (0.71429 0.28571)  
                                        1.09e+06) bang&lt; 0.0765 4    0 n (1.00000 0.00000) *
                                        1.09e+06) bang&gt;=0.0765 3    1 y (0.33333 0.66667)  
                                          2.18e+06) crl.tot&gt;=76 2    1 n (0.50000 0.50000)  
                                            4.36e+06) crl.tot&lt; 80 1    0 n (1.00000 0.00000) *
                                            4.36e+06) crl.tot&gt;=80 1    0 y (0.00000 1.00000) *
                                          2.18e+06) crl.tot&lt; 76 1    0 y (0.00000 1.00000) *
                                      5.45e+05) crl.tot&lt; 68 2    0 y (0.00000 1.00000) *
                              3.41e+04) crl.tot&lt; 36.5 101   15 n (0.85149 0.14851) *
                          8.52e+03) make&gt;=0.5 6    2 n (0.66667 0.33333)  
                            1.70e+04) crl.tot&lt; 78 4    0 n (1.00000 0.00000) *
                            1.70e+04) crl.tot&gt;=78 2    0 y (0.00000 1.00000) *
                      2.13e+03) make&gt;=2.21 2    1 n (0.50000 0.50000)  
                        4.26e+03) crl.tot&lt; 40 1    0 n (1.00000 0.00000) *
                        4.26e+03) crl.tot&gt;=40 1    0 y (0.00000 1.00000) *
                    1.06e+03) crl.tot&gt;=98.5 627   90 n (0.85646 0.14354)  
                      2.13e+03) bang&lt; 0.0875 624   88 n (0.85897 0.14103)  
                        4.26e+03) crl.tot&gt;=186 272   29 n (0.89338 0.10662)  
                          8.52e+03) crl.tot&lt; 208 50    0 n (1.00000 0.00000) *
                          8.52e+03) crl.tot&gt;=208 222   29 n (0.86937 0.13063)  
                            1.70e+04) crl.tot&gt;=208 219   27 n (0.87671 0.12329)  
                              3.41e+04) n000&lt; 0.135 215   25 n (0.88372 0.11628)  
                                6.82e+04) make&gt;=0.035 48    2 n (0.95833 0.04167)  
                                  1.36e+05) make&lt; 0.405 43    1 n (0.97674 0.02326)  
                                    2.73e+05) crl.tot&lt; 411 31    0 n (1.00000 0.00000) *
                                    2.73e+05) crl.tot&gt;=411 12    1 n (0.91667 0.08333)  
                                      5.45e+05) crl.tot&gt;=416 11    0 n (1.00000 0.00000) *
                                      5.45e+05) crl.tot&lt; 416 1    0 y (0.00000 1.00000) *
                                  1.36e+05) make&gt;=0.405 5    1 n (0.80000 0.20000)  
                                    2.73e+05) make&gt;=0.42 4    0 n (1.00000 0.00000) *
                                    2.73e+05) make&lt; 0.42 1    0 y (0.00000 1.00000) *
                                6.82e+04) make&lt; 0.035 167   23 n (0.86228 0.13772)  
                                  1.36e+05) crl.tot&lt; 480 160   20 n (0.87500 0.12500)  
                                    2.73e+05) dollar&lt; 0.0315 158   19 n (0.87975 0.12025)  
                                      5.45e+05) bang&gt;=0.0375 28    1 n (0.96429 0.03571)  
                                        1.09e+06) crl.tot&lt; 427 27    0 n (1.00000 0.00000) *
                                        1.09e+06) crl.tot&gt;=427 1    0 y (0.00000 1.00000) *
                                      5.45e+05) bang&lt; 0.0375 130   18 n (0.86154 0.13846)  
                                        1.09e+06) bang&lt; 0.032 126   14 n (0.88889 0.11111)  
                                          2.18e+06) crl.tot&gt;=250 97    8 n (0.91753 0.08247)  
                                            4.36e+06) crl.tot&lt; 358 51    2 n (0.96078 0.03922)  
                                              8.73e+06) crl.tot&gt;=292 30    0 n (1.00000 0.00000) *
                                              8.73e+06) crl.tot&lt; 292 21    2 n (0.90476 0.09524)  
                                                1.75e+07) crl.tot&lt; 291 20    1 n (0.95000 0.05000)  
                                                  3.49e+07) crl.tot&gt;=266 11    0 n (1.00000 0.00000) *
                                                  3.49e+07) crl.tot&lt; 266 9    1 n (0.88889 0.11111)  
                                                    6.98e+07) crl.tot&lt; 264 8    0 n (1.00000 0.00000) *
                                                    6.98e+07) crl.tot&gt;=264 1    0 y (0.00000 1.00000) *
                                                1.75e+07) crl.tot&gt;=291 1    0 y (0.00000 1.00000) *
                                            4.36e+06) crl.tot&gt;=358 46    6 n (0.86957 0.13043)  
                                              8.73e+06) crl.tot&gt;=366 43    4 n (0.90698 0.09302)  
                                                1.75e+07) crl.tot&lt; 378 13    0 n (1.00000 0.00000) *
                                                1.75e+07) crl.tot&gt;=378 30    4 n (0.86667 0.13333)  
                                                  3.49e+07) crl.tot&gt;=380 29    3 n (0.89655 0.10345)  
                                                    6.98e+07) crl.tot&lt; 399 9    0 n (1.00000 0.00000) *
                                                    6.98e+07) crl.tot&gt;=399 20    3 n (0.85000 0.15000)  
                                                      1.40e+08) crl.tot&gt;=406 19    2 n (0.89474 0.10526)  
                                                        2.79e+08) crl.tot&lt; 424 5    0 n (1.00000 0.00000) *
                                                        2.79e+08) crl.tot&gt;=424 14    2 n (0.85714 0.14286)  
                                                          5.58e+08) crl.tot&gt;=426 13    1 n (0.92308 0.07692) *
                                                          5.58e+08) crl.tot&lt; 426 1    0 y (0.00000 1.00000) *
                                                      1.40e+08) crl.tot&lt; 406 1    0 y (0.00000 1.00000) *
                                                  3.49e+07) crl.tot&lt; 380 1    0 y (0.00000 1.00000) *
                                              8.73e+06) crl.tot&lt; 366 3    1 y (0.33333 0.66667)  
                                                1.75e+07) dollar&gt;=0.012 1    0 n (1.00000 0.00000) *
                                                1.75e+07) dollar&lt; 0.012 2    0 y (0.00000 1.00000) *
                                          2.18e+06) crl.tot&lt; 250 29    6 n (0.79310 0.20690)  
                                            4.36e+06) crl.tot&lt; 240 25    3 n (0.88000 0.12000)  
                                              8.73e+06) crl.tot&gt;=235 9    0 n (1.00000 0.00000) *
                                              8.73e+06) crl.tot&lt; 235 16    3 n (0.81250 0.18750)  
                                                1.75e+07) crl.tot&lt; 233 15    2 n (0.86667 0.13333)  
                                                  3.49e+07) crl.tot&lt; 228 12    1 n (0.91667 0.08333) *
                                                  3.49e+07) crl.tot&gt;=228 3    1 n (0.66667 0.33333)  
                                                    6.98e+07) crl.tot&gt;=229 2    0 n (1.00000 0.00000) *
                                                    6.98e+07) crl.tot&lt; 229 1    0 y (0.00000 1.00000) *
                                                1.75e+07) crl.tot&gt;=233 1    0 y (0.00000 1.00000) *
                                            4.36e+06) crl.tot&gt;=240 4    1 y (0.25000 0.75000)  
                                              8.73e+06) crl.tot&gt;=244 2    1 n (0.50000 0.50000)  
                                                1.75e+07) crl.tot&lt; 248 1    0 n (1.00000 0.00000) *
                                                1.75e+07) crl.tot&gt;=248 1    0 y (0.00000 1.00000) *
                                              8.73e+06) crl.tot&lt; 244 2    0 y (0.00000 1.00000) *
                                        1.09e+06) bang&gt;=0.032 4    0 y (0.00000 1.00000) *
                                    2.73e+05) dollar&gt;=0.0315 2    1 n (0.50000 0.50000)  
                                      5.45e+05) crl.tot&gt;=274 1    0 n (1.00000 0.00000) *
                                      5.45e+05) crl.tot&lt; 274 1    0 y (0.00000 1.00000) *
                                  1.36e+05) crl.tot&gt;=480 7    3 n (0.57143 0.42857)  
                                    2.73e+05) crl.tot&gt;=494 3    0 n (1.00000 0.00000) *
                                    2.73e+05) crl.tot&lt; 494 4    1 y (0.25000 0.75000)  
                                      5.45e+05) crl.tot&gt;=484 2    1 n (0.50000 0.50000)  
                                        1.09e+06) crl.tot&lt; 488 1    0 n (1.00000 0.00000) *
                                        1.09e+06) crl.tot&gt;=488 1    0 y (0.00000 1.00000) *
                                      5.45e+05) crl.tot&lt; 484 2    0 y (0.00000 1.00000) *
                              3.41e+04) n000&gt;=0.135 4    2 n (0.50000 0.50000)  
                                6.82e+04) dollar&lt; 0.0195 2    0 n (1.00000 0.00000) *
                                6.82e+04) dollar&gt;=0.0195 2    0 y (0.00000 1.00000) *
                            1.70e+04) crl.tot&lt; 208 3    1 y (0.33333 0.66667)  
                              3.41e+04) bang&gt;=0.0595 1    0 n (1.00000 0.00000) *
                              3.41e+04) bang&lt; 0.0595 2    0 y (0.00000 1.00000) *
                        4.26e+03) crl.tot&lt; 186 352   59 n (0.83239 0.16761)  
                          8.52e+03) crl.tot&lt; 186 348   57 n (0.83621 0.16379)  
                            1.70e+04) make&gt;=0.315 29    1 n (0.96552 0.03448)  
                              3.41e+04) bang&lt; 0.045 21    0 n (1.00000 0.00000) *
                              3.41e+04) bang&gt;=0.045 8    1 n (0.87500 0.12500)  
                                6.82e+04) bang&gt;=0.047 7    0 n (1.00000 0.00000) *
                                6.82e+04) bang&lt; 0.047 1    0 y (0.00000 1.00000) *
                            1.70e+04) make&lt; 0.315 319   56 n (0.82445 0.17555)  
                              3.41e+04) make&lt; 0.305 318   55 n (0.82704 0.17296)  
                                6.82e+04) dollar&lt; 0.0095 313   53 n (0.83067 0.16933)  
                                  1.36e+05) make&lt; 0.265 308   51 n (0.83442 0.16558)  
                                    2.73e+05) make&gt;=0.06 13    0 n (1.00000 0.00000) *
                                    2.73e+05) make&lt; 0.06 295   51 n (0.82712 0.17288)  
                                      5.45e+05) crl.tot&gt;=172 24    2 n (0.91667 0.08333) *
                                      5.45e+05) crl.tot&lt; 172 271   49 n (0.81919 0.18081)  
                                        1.09e+06) crl.tot&lt; 170 266   47 n (0.82331 0.17669)  
                                          2.18e+06) crl.tot&gt;=106 228   38 n (0.83333 0.16667)  
                                            4.36e+06) bang&gt;=0.0535 11    0 n (1.00000 0.00000) *
                                            4.36e+06) bang&lt; 0.0535 217   38 n (0.82488 0.17512)  
                                              8.73e+06) bang&lt; 0.0495 215   36 n (0.83256 0.16744)  
                                                1.75e+07) crl.tot&gt;=166 8    0 n (1.00000 0.00000) *
                                                1.75e+07) crl.tot&lt; 166 207   36 n (0.82609 0.17391)  
                                                  3.49e+07) bang&lt; 0.043 202   34 n (0.83168 0.16832)  
                                                    6.98e+07) crl.tot&lt; 165 200   33 n (0.83500 0.16500)  
                                                      1.40e+08) crl.tot&gt;=162 5    0 n (1.00000 0.00000) *
                                                      1.40e+08) crl.tot&lt; 162 195   33 n (0.83077 0.16923)  
                                                        2.79e+08) crl.tot&lt; 162 191   31 n (0.83770 0.16230)  
                                                          5.59e+08) crl.tot&gt;=146 40    4 n (0.90000 0.10000) *
                                                          5.59e+08) crl.tot&lt; 146 151   27 n (0.82119 0.17881)  
                                                            1.12e+09) crl.tot&lt; 144 144   23 n (0.84028 0.15972) *
                                                            1.12e+09) crl.tot&gt;=144 7    3 y (0.42857 0.57143) *
                                                        2.79e+08) crl.tot&gt;=162 4    2 n (0.50000 0.50000) *
                                                    6.98e+07) crl.tot&gt;=165 2    1 n (0.50000 0.50000) *
                                                  3.49e+07) bang&gt;=0.043 5    2 n (0.60000 0.40000)  
                                                    6.98e+07) bang&gt;=0.0465 3    0 n (1.00000 0.00000) *
                                                    6.98e+07) bang&lt; 0.0465 2    0 y (0.00000 1.00000) *
                                              8.73e+06) bang&gt;=0.0495 2    0 y (0.00000 1.00000) *
                                          2.18e+06) crl.tot&lt; 106 38    9 n (0.76316 0.23684)  
                                            4.36e+06) crl.tot&lt; 106 30    5 n (0.83333 0.16667)  
                                              8.73e+06) bang&lt; 0.0755 29    4 n (0.86207 0.13793)  
                                                1.75e+07) crl.tot&gt;=102 14    1 n (0.92857 0.07143) *
                                                1.75e+07) crl.tot&lt; 102 15    3 n (0.80000 0.20000)  
                                                  3.49e+07) crl.tot&lt; 102 14    2 n (0.85714 0.14286) *
                                                  3.49e+07) crl.tot&gt;=102 1    0 y (0.00000 1.00000) *
                                              8.73e+06) bang&gt;=0.0755 1    0 y (0.00000 1.00000) *
                                            4.36e+06) crl.tot&gt;=106 8    4 n (0.50000 0.50000)  
                                              8.73e+06) bang&gt;=0.0195 2    0 n (1.00000 0.00000) *
                                              8.73e+06) bang&lt; 0.0195 6    2 y (0.33333 0.66667) *
                                        1.09e+06) crl.tot&gt;=170 5    2 n (0.60000 0.40000)  
                                          2.18e+06) bang&gt;=0.0775 1    0 n (1.00000 0.00000) *
                                          2.18e+06) bang&lt; 0.0775 4    2 n (0.50000 0.50000)  
                                            4.36e+06) bang&lt; 0.0385 3    1 n (0.66667 0.33333) *
                                            4.36e+06) bang&gt;=0.0385 1    0 y (0.00000 1.00000) *
                                  1.36e+05) make&gt;=0.265 5    2 n (0.60000 0.40000)  
                                    2.73e+05) make&gt;=0.295 2    0 n (1.00000 0.00000) *
                                    2.73e+05) make&lt; 0.295 3    1 y (0.33333 0.66667)  
                                      5.45e+05) bang&gt;=0.04 1    0 n (1.00000 0.00000) *
                                      5.45e+05) bang&lt; 0.04 2    0 y (0.00000 1.00000) *
                                6.82e+04) dollar&gt;=0.0095 5    2 n (0.60000 0.40000)  
                                  1.36e+05) crl.tot&lt; 170 3    0 n (1.00000 0.00000) *
                                  1.36e+05) crl.tot&gt;=170 2    0 y (0.00000 1.00000) *
                              3.41e+04) make&gt;=0.305 1    0 y (0.00000 1.00000) *
                          8.52e+03) crl.tot&gt;=186 4    2 n (0.50000 0.50000)  
                            1.70e+04) make&lt; 0.355 3    1 n (0.66667 0.33333) *
                            1.70e+04) make&gt;=0.355 1    0 y (0.00000 1.00000) *
                      2.13e+03) bang&gt;=0.0875 3    1 y (0.33333 0.66667)  
                        4.26e+03) crl.tot&gt;=176 1    0 n (1.00000 0.00000) *
                        4.26e+03) crl.tot&lt; 176 2    0 y (0.00000 1.00000) *
                  5.33e+02) crl.tot&gt;=502 6    3 n (0.50000 0.50000)  
                    1.07e+03) dollar&gt;=0.0155 2    0 n (1.00000 0.00000) *
                    1.07e+03) dollar&lt; 0.0155 4    1 y (0.25000 0.75000)  
                      2.13e+03) crl.tot&gt;=506 2    1 n (0.50000 0.50000)  
                        4.27e+03) bang&lt; 0.0165 1    0 n (1.00000 0.00000) *
                        4.27e+03) bang&gt;=0.0165 1    0 y (0.00000 1.00000) *
                      2.14e+03) crl.tot&lt; 506 2    0 y (0.00000 1.00000) *
                2.67e+02) dollar&gt;=0.039 30   11 n (0.63333 0.36667)  
                  5.34e+02) make&lt; 0.11 25    6 n (0.76000 0.24000)  
                    1.07e+03) crl.tot&lt; 478 23    4 n (0.82609 0.17391)  
                      2.14e+03) n000&lt; 0.18 22    3 n (0.86364 0.13636)  
                        4.27e+03) dollar&gt;=0.049 7    0 n (1.00000 0.00000) *
                        4.27e+03) dollar&lt; 0.049 15    3 n (0.80000 0.20000)  
                          8.55e+03) crl.tot&gt;=166 9    1 n (0.88889 0.11111)  
                            1.71e+04) crl.tot&lt; 410 6    0 n (1.00000 0.00000) *
                            1.71e+04) crl.tot&gt;=410 3    1 n (0.66667 0.33333)  
                              3.42e+04) crl.tot&gt;=420 2    0 n (1.00000 0.00000) *
                              3.42e+04) crl.tot&lt; 420 1    0 y (0.00000 1.00000) *
                          8.55e+03) crl.tot&lt; 166 6    2 n (0.66667 0.33333)  
                            1.71e+04) crl.tot&lt; 160 5    1 n (0.80000 0.20000) *
                            1.71e+04) crl.tot&gt;=160 1    0 y (0.00000 1.00000) *
                      2.14e+03) n000&gt;=0.18 1    0 y (0.00000 1.00000) *
                    1.07e+03) crl.tot&gt;=478 2    0 y (0.00000 1.00000) *
                  5.35e+02) make&gt;=0.11 5    0 y (0.00000 1.00000) *
            6.70e+01) crl.tot&gt;=3.24e+03 8    4 n (0.50000 0.50000)  
              1.34e+02) crl.tot&gt;=3.33e+03 6    2 n (0.66667 0.33333)  
                2.68e+02) make&lt; 0.07 4    0 n (1.00000 0.00000) *
                2.69e+02) make&gt;=0.07 2    0 y (0.00000 1.00000) *
              1.35e+02) crl.tot&lt; 3.33e+03 2    0 y (0.00000 1.00000) *
        1.70e+01) money&gt;=0.035 48   19 n (0.60417 0.39583)  
          3.40e+01) bang&lt; 0.08 45   16 n (0.64444 0.35556)  
            6.80e+01) crl.tot&lt; 1.06e+03 40   12 n (0.70000 0.30000)  
              1.36e+02) money&lt; 1.33 26    4 n (0.84615 0.15385)  
                2.72e+02) bang&lt; 0.0585 19    1 n (0.94737 0.05263)  
                  5.44e+02) money&gt;=0.075 16    0 n (1.00000 0.00000) *
                  5.45e+02) money&lt; 0.075 3    1 n (0.66667 0.33333)  
                    1.09e+03) crl.tot&gt;=420 2    0 n (1.00000 0.00000) *
                    1.09e+03) crl.tot&lt; 420 1    0 y (0.00000 1.00000) *
                2.73e+02) bang&gt;=0.0585 7    3 n (0.57143 0.42857)  
                  5.46e+02) crl.tot&gt;=373 3    0 n (1.00000 0.00000) *
                  5.47e+02) crl.tot&lt; 373 4    1 y (0.25000 0.75000)  
                    1.09e+03) bang&gt;=0.072 1    0 n (1.00000 0.00000) *
                    1.10e+03) bang&lt; 0.072 3    0 y (0.00000 1.00000) *
              1.37e+02) money&gt;=1.33 14    6 y (0.42857 0.57143)  
                2.74e+02) crl.tot&lt; 54.5 8    2 n (0.75000 0.25000)  
                  5.48e+02) crl.tot&gt;=4.5 7    1 n (0.85714 0.14286)  
                    1.10e+03) money&gt;=1.54 6    0 n (1.00000 0.00000) *
                    1.10e+03) money&lt; 1.54 1    0 y (0.00000 1.00000) *
                  5.49e+02) crl.tot&lt; 4.5 1    0 y (0.00000 1.00000) *
                2.75e+02) crl.tot&gt;=54.5 6    0 y (0.00000 1.00000) *
            6.90e+01) crl.tot&gt;=1.06e+03 5    1 y (0.20000 0.80000)  
              1.38e+02) make&gt;=0.08 1    0 n (1.00000 0.00000) *
              1.39e+02) make&lt; 0.08 4    0 y (0.00000 1.00000) *
          3.50e+01) bang&gt;=0.08 3    0 y (0.00000 1.00000) *
      9.00e+00) n000&gt;=0.26 21    7 y (0.33333 0.66667)  
        1.80e+01) n000&gt;=0.665 4    0 n (1.00000 0.00000) *
        1.90e+01) n000&lt; 0.665 17    3 y (0.17647 0.82353)  
          3.80e+01) dollar&gt;=0.024 3    1 n (0.66667 0.33333)  
            7.60e+01) crl.tot&gt;=293 2    0 n (1.00000 0.00000) *
            7.70e+01) crl.tot&lt; 293 1    0 y (0.00000 1.00000) *
          3.90e+01) dollar&lt; 0.024 14    1 y (0.07143 0.92857)  
            7.80e+01) make&gt;=0.345 1    0 n (1.00000 0.00000) *
            7.90e+01) make&lt; 0.345 13    0 y (0.00000 1.00000) *
    5.00e+00) bang&gt;=0.0915 1051  481 y (0.45766 0.54234)  
      1.00e+01) crl.tot&lt; 85.5 535  175 n (0.67290 0.32710)  
        2.00e+01) bang&lt; 0.774 418  106 n (0.74641 0.25359)  
          4.00e+01) money&lt; 0.835 408   97 n (0.76225 0.23775)  
            8.00e+01) crl.tot&lt; 51.5 255   40 n (0.84314 0.15686)  
              1.60e+02) n000&lt; 0.64 254   39 n (0.84646 0.15354)  
                3.20e+02) crl.tot&lt; 12.5 13    0 n (1.00000 0.00000) *
                3.21e+02) crl.tot&gt;=12.5 241   39 n (0.83817 0.16183)  
                  6.42e+02) bang&lt; 0.191 64    6 n (0.90625 0.09375)  
                    1.28e+03) bang&gt;=0.114 52    3 n (0.94231 0.05769)  
                      2.57e+03) bang&gt;=0.165 22    0 n (1.00000 0.00000) *
                      2.57e+03) bang&lt; 0.165 30    3 n (0.90000 0.10000)  
                        5.14e+03) bang&lt; 0.145 17    0 n (1.00000 0.00000) *
                        5.14e+03) bang&gt;=0.145 13    3 n (0.76923 0.23077)  
                          1.03e+04) bang&gt;=0.148 10    1 n (0.90000 0.10000)  
                            2.06e+04) bang&lt; 0.163 8    0 n (1.00000 0.00000) *
                            2.06e+04) bang&gt;=0.163 2    1 n (0.50000 0.50000)  
                              4.11e+04) crl.tot&lt; 37 1    0 n (1.00000 0.00000) *
                              4.11e+04) crl.tot&gt;=37 1    0 y (0.00000 1.00000) *
                          1.03e+04) bang&lt; 0.148 3    1 y (0.33333 0.66667)  
                            2.06e+04) crl.tot&gt;=22.5 2    1 n (0.50000 0.50000)  
                              4.11e+04) crl.tot&lt; 29.5 1    0 n (1.00000 0.00000) *
                              4.11e+04) crl.tot&gt;=29.5 1    0 y (0.00000 1.00000) *
                            2.06e+04) crl.tot&lt; 22.5 1    0 y (0.00000 1.00000) *
                    1.28e+03) bang&lt; 0.114 12    3 n (0.75000 0.25000)  
                      2.57e+03) bang&lt; 0.108 7    0 n (1.00000 0.00000) *
                      2.57e+03) bang&gt;=0.108 5    2 y (0.40000 0.60000)  
                        5.14e+03) crl.tot&gt;=29 4    2 n (0.50000 0.50000)  
                          1.03e+04) crl.tot&lt; 47.5 3    1 n (0.66667 0.33333)  
                            2.06e+04) crl.tot&gt;=38.5 1    0 n (1.00000 0.00000) *
                            2.06e+04) crl.tot&lt; 38.5 2    1 n (0.50000 0.50000)  
                              4.11e+04) make&gt;=0.28 1    0 n (1.00000 0.00000) *
                              4.11e+04) make&lt; 0.28 1    0 y (0.00000 1.00000) *
                          1.03e+04) crl.tot&gt;=47.5 1    0 y (0.00000 1.00000) *
                        5.14e+03) crl.tot&lt; 29 1    0 y (0.00000 1.00000) *
                  6.43e+02) bang&gt;=0.191 177   33 n (0.81356 0.18644)  
                    1.29e+03) bang&gt;=0.204 169   29 n (0.82840 0.17160)  
                      2.57e+03) bang&lt; 0.263 31    2 n (0.93548 0.06452)  
                        5.14e+03) crl.tot&gt;=26 26    1 n (0.96154 0.03846)  
                          1.03e+04) crl.tot&lt; 47.5 21    0 n (1.00000 0.00000) *
                          1.03e+04) crl.tot&gt;=47.5 5    1 n (0.80000 0.20000)  
                            2.06e+04) crl.tot&gt;=48.5 4    0 n (1.00000 0.00000) *
                            2.06e+04) crl.tot&lt; 48.5 1    0 y (0.00000 1.00000) *
                        5.14e+03) crl.tot&lt; 26 5    1 n (0.80000 0.20000)  
                          1.03e+04) crl.tot&lt; 24.5 4    0 n (1.00000 0.00000) *
                          1.03e+04) crl.tot&gt;=24.5 1    0 y (0.00000 1.00000) *
                      2.57e+03) bang&gt;=0.263 138   27 n (0.80435 0.19565)  
                        5.15e+03) make&lt; 1.74 137   26 n (0.81022 0.18978)  
                          1.03e+04) bang&gt;=0.329 112   19 n (0.83036 0.16964)  
                            2.06e+04) crl.tot&lt; 48.5 111   18 n (0.83784 0.16216)  
                              4.12e+04) bang&lt; 0.615 79   10 n (0.87342 0.12658)  
                                8.23e+04) bang&gt;=0.549 10    0 n (1.00000 0.00000) *
                                8.23e+04) bang&lt; 0.549 69   10 n (0.85507 0.14493)  
                                  1.65e+05) bang&lt; 0.534 65    8 n (0.87692 0.12308)  
                                    3.29e+05) bang&lt; 0.35 9    0 n (1.00000 0.00000) *
                                    3.29e+05) bang&gt;=0.35 56    8 n (0.85714 0.14286)  
                                      6.59e+05) bang&gt;=0.352 55    7 n (0.87273 0.12727)  
                                        1.32e+06) crl.tot&gt;=26.5 36    3 n (0.91667 0.08333)  
                                          2.63e+06) bang&gt;=0.417 22    0 n (1.00000 0.00000) *
                                          2.63e+06) bang&lt; 0.417 14    3 n (0.78571 0.21429)  
                                            5.27e+06) bang&lt; 0.414 13    2 n (0.84615 0.15385)  
                                              1.05e+07) crl.tot&lt; 45.5 11    1 n (0.90909 0.09091)  
                                                2.11e+07) crl.tot&lt; 29.5 5    0 n (1.00000 0.00000) *
                                                2.11e+07) crl.tot&gt;=29.5 6    1 n (0.83333 0.16667)  
                                                  4.22e+07) crl.tot&gt;=31.5 5    0 n (1.00000 0.00000) *
                                                  4.22e+07) crl.tot&lt; 31.5 1    0 y (0.00000 1.00000) *
                                              1.05e+07) crl.tot&gt;=45.5 2    1 n (0.50000 0.50000)  
                                                2.11e+07) bang&gt;=0.392 1    0 n (1.00000 0.00000) *
                                                2.11e+07) bang&lt; 0.392 1    0 y (0.00000 1.00000) *
                                            5.27e+06) bang&gt;=0.414 1    0 y (0.00000 1.00000) *
                                        1.32e+06) crl.tot&lt; 26.5 19    4 n (0.78947 0.21053)  
                                          2.63e+06) bang&lt; 0.452 12    1 n (0.91667 0.08333)  
                                            5.27e+06) crl.tot&lt; 25 10    0 n (1.00000 0.00000) *
                                            5.27e+06) crl.tot&gt;=25 2    1 n (0.50000 0.50000)  
                                              1.05e+07) bang&gt;=0.397 1    0 n (1.00000 0.00000) *
                                              1.05e+07) bang&lt; 0.397 1    0 y (0.00000 1.00000) *
                                          2.63e+06) bang&gt;=0.452 7    3 n (0.57143 0.42857)  
                                            5.27e+06) bang&gt;=0.471 5    1 n (0.80000 0.20000)  
                                              1.05e+07) crl.tot&gt;=18 4    0 n (1.00000 0.00000) *
                                              1.05e+07) crl.tot&lt; 18 1    0 y (0.00000 1.00000) *
                                            5.27e+06) bang&lt; 0.471 2    0 y (0.00000 1.00000) *
                                      6.59e+05) bang&lt; 0.352 1    0 y (0.00000 1.00000) *
                                  1.65e+05) bang&gt;=0.534 4    2 n (0.50000 0.50000)  
                                    3.29e+05) crl.tot&lt; 15 1    0 n (1.00000 0.00000) *
                                    3.29e+05) crl.tot&gt;=15 3    1 y (0.33333 0.66667)  
                                      6.59e+05) crl.tot&lt; 19.5 2    1 n (0.50000 0.50000)  
                                        1.32e+06) bang&gt;=0.545 1    0 n (1.00000 0.00000) *
                                        1.32e+06) bang&lt; 0.545 1    0 y (0.00000 1.00000) *
                                      6.59e+05) crl.tot&gt;=19.5 1    0 y (0.00000 1.00000) *
                              4.12e+04) bang&gt;=0.615 32    8 n (0.75000 0.25000)  
                                8.23e+04) crl.tot&lt; 27 25    3 n (0.88000 0.12000)  
                                  1.65e+05) bang&gt;=0.618 24    2 n (0.91667 0.08333)  
                                    3.29e+05) crl.tot&gt;=14 20    1 n (0.95000 0.05000)  
                                      6.59e+05) crl.tot&lt; 22.5 15    0 n (1.00000 0.00000) *
                                      6.59e+05) crl.tot&gt;=22.5 5    1 n (0.80000 0.20000)  
                                        1.32e+06) bang&lt; 0.719 3    0 n (1.00000 0.00000) *
                                        1.32e+06) bang&gt;=0.719 2    1 n (0.50000 0.50000)  
                                          2.63e+06) crl.tot&gt;=24.5 1    0 n (1.00000 0.00000) *
                                          2.63e+06) crl.tot&lt; 24.5 1    0 y (0.00000 1.00000) *
                                    3.29e+05) crl.tot&lt; 14 4    1 n (0.75000 0.25000)  
                                      6.59e+05) bang&gt;=0.728 2    0 n (1.00000 0.00000) *
                                      6.59e+05) bang&lt; 0.728 2    1 n (0.50000 0.50000)  
                                        1.32e+06) bang&lt; 0.702 1    0 n (1.00000 0.00000) *
                                        1.32e+06) bang&gt;=0.702 1    0 y (0.00000 1.00000) *
                                  1.65e+05) bang&lt; 0.618 1    0 y (0.00000 1.00000) *
                                8.23e+04) crl.tot&gt;=27 7    2 y (0.28571 0.71429)  
                                  1.65e+05) crl.tot&gt;=40.5 1    0 n (1.00000 0.00000) *
                                  1.65e+05) crl.tot&lt; 40.5 6    1 y (0.16667 0.83333)  
                                    3.29e+05) bang&lt; 0.69 3    1 y (0.33333 0.66667)  
                                      6.59e+05) bang&gt;=0.677 1    0 n (1.00000 0.00000) *
                                      6.59e+05) bang&lt; 0.677 2    0 y (0.00000 1.00000) *
                                    3.29e+05) bang&gt;=0.69 3    0 y (0.00000 1.00000) *
                            2.06e+04) crl.tot&gt;=48.5 1    0 y (0.00000 1.00000) *
                          1.03e+04) bang&lt; 0.329 25    7 n (0.72000 0.28000)  
                            2.06e+04) crl.tot&gt;=21.5 20    4 n (0.80000 0.20000)  
                              4.12e+04) bang&lt; 0.288 10    0 n (1.00000 0.00000) *
                              4.12e+04) bang&gt;=0.288 10    4 n (0.60000 0.40000)  
                                8.23e+04) bang&gt;=0.311 6    1 n (0.83333 0.16667)  
                                  1.65e+05) crl.tot&gt;=46.5 3    0 n (1.00000 0.00000) *
                                  1.65e+05) crl.tot&lt; 46.5 3    1 n (0.66667 0.33333)  
                                    3.29e+05) crl.tot&lt; 36.5 2    0 n (1.00000 0.00000) *
                                    3.29e+05) crl.tot&gt;=36.5 1    0 y (0.00000 1.00000) *
                                8.23e+04) bang&lt; 0.311 4    1 y (0.25000 0.75000)  
                                  1.65e+05) crl.tot&lt; 38.5 2    1 n (0.50000 0.50000)  
                                    3.29e+05) crl.tot&gt;=33 1    0 n (1.00000 0.00000) *
                                    3.29e+05) crl.tot&lt; 33 1    0 y (0.00000 1.00000) *
                                  1.65e+05) crl.tot&gt;=38.5 2    0 y (0.00000 1.00000) *
                            2.06e+04) crl.tot&lt; 21.5 5    2 y (0.40000 0.60000)  
                              4.12e+04) crl.tot&lt; 15 2    0 n (1.00000 0.00000) *
                              4.12e+04) crl.tot&gt;=15 3    0 y (0.00000 1.00000) *
                        5.15e+03) make&gt;=1.74 1    0 y (0.00000 1.00000) *
                    1.29e+03) bang&lt; 0.204 8    4 n (0.50000 0.50000)  
                      2.57e+03) crl.tot&lt; 28 2    0 n (1.00000 0.00000) *
                      2.58e+03) crl.tot&gt;=28 6    2 y (0.33333 0.66667)  
                        5.15e+03) crl.tot&lt; 44 4    2 n (0.50000 0.50000)  
                          1.03e+04) crl.tot&gt;=36.5 3    1 n (0.66667 0.33333)  
                            2.06e+04) crl.tot&gt;=41.5 1    0 n (1.00000 0.00000) *
                            2.06e+04) crl.tot&lt; 41.5 2    1 n (0.50000 0.50000)  
                              4.12e+04) bang&gt;=0.203 1    0 n (1.00000 0.00000) *
                              4.12e+04) bang&lt; 0.203 1    0 y (0.00000 1.00000) *
                          1.03e+04) crl.tot&lt; 36.5 1    0 y (0.00000 1.00000) *
                        5.15e+03) crl.tot&gt;=44 2    0 y (0.00000 1.00000) *
              1.61e+02) n000&gt;=0.64 1    0 y (0.00000 1.00000) *
            8.10e+01) crl.tot&gt;=51.5 153   57 n (0.62745 0.37255)  
              1.62e+02) bang&lt; 0.406 115   31 n (0.73043 0.26957)  
                3.24e+02) bang&lt; 0.171 40    5 n (0.87500 0.12500)  
                  6.48e+02) bang&gt;=0.133 18    0 n (1.00000 0.00000) *
                  6.49e+02) bang&lt; 0.133 22    5 n (0.77273 0.22727)  
                    1.30e+03) crl.tot&gt;=62 19    3 n (0.84211 0.15789)  
                      2.60e+03) bang&lt; 0.13 18    2 n (0.88889 0.11111)  
                        5.19e+03) make&lt; 0.525 17    1 n (0.94118 0.05882)  
                          1.04e+04) crl.tot&gt;=68.5 13    0 n (1.00000 0.00000) *
                          1.04e+04) crl.tot&lt; 68.5 4    1 n (0.75000 0.25000)  
                            2.08e+04) bang&lt; 0.117 3    0 n (1.00000 0.00000) *
                            2.08e+04) bang&gt;=0.117 1    0 y (0.00000 1.00000) *
                        5.19e+03) make&gt;=0.525 1    0 y (0.00000 1.00000) *
                      2.60e+03) bang&gt;=0.13 1    0 y (0.00000 1.00000) *
                    1.30e+03) crl.tot&lt; 62 3    1 y (0.33333 0.66667)  
                      2.60e+03) bang&gt;=0.109 1    0 n (1.00000 0.00000) *
                      2.60e+03) bang&lt; 0.109 2    0 y (0.00000 1.00000) *
                3.25e+02) bang&gt;=0.171 75   26 n (0.65333 0.34667)  
                  6.50e+02) bang&gt;=0.175 72   23 n (0.68056 0.31944)  
                    1.30e+03) crl.tot&lt; 80.5 65   18 n (0.72308 0.27692)  
                      2.60e+03) crl.tot&gt;=54.5 55   12 n (0.78182 0.21818)  
                        5.20e+03) make&lt; 1.51 54   11 n (0.79630 0.20370)  
                          1.04e+04) make&gt;=0.27 8    0 n (1.00000 0.00000) *
                          1.04e+04) make&lt; 0.27 46   11 n (0.76087 0.23913)  
                            2.08e+04) bang&gt;=0.195 43    9 n (0.79070 0.20930)  
                              4.16e+04) crl.tot&lt; 68.5 24    3 n (0.87500 0.12500)  
                                8.32e+04) crl.tot&gt;=60 15    0 n (1.00000 0.00000) *
                                8.32e+04) crl.tot&lt; 60 9    3 n (0.66667 0.33333)  
                                  1.66e+05) crl.tot&lt; 57.5 6    1 n (0.83333 0.16667)  
                                    3.33e+05) bang&lt; 0.297 3    0 n (1.00000 0.00000) *
                                    3.33e+05) bang&gt;=0.297 3    1 n (0.66667 0.33333)  
                                      6.66e+05) bang&gt;=0.317 2    0 n (1.00000 0.00000) *
                                      6.66e+05) bang&lt; 0.317 1    0 y (0.00000 1.00000) *
                                  1.66e+05) crl.tot&gt;=57.5 3    1 y (0.33333 0.66667)  
                                    3.33e+05) bang&lt; 0.274 1    0 n (1.00000 0.00000) *
                                    3.33e+05) bang&gt;=0.274 2    0 y (0.00000 1.00000) *
                              4.16e+04) crl.tot&gt;=68.5 19    6 n (0.68421 0.31579)  
                                8.32e+04) crl.tot&gt;=75.5 13    3 n (0.76923 0.23077)  
                                  1.66e+05) bang&gt;=0.259 8    1 n (0.87500 0.12500)  
                                    3.33e+05) bang&lt; 0.35 5    0 n (1.00000 0.00000) *
                                    3.33e+05) bang&gt;=0.35 3    1 n (0.66667 0.33333)  
                                      6.66e+05) bang&gt;=0.368 2    0 n (1.00000 0.00000) *
                                      6.66e+05) bang&lt; 0.368 1    0 y (0.00000 1.00000) *
                                  1.66e+05) bang&lt; 0.259 5    2 n (0.60000 0.40000)  
                                    3.33e+05) bang&lt; 0.212 2    0 n (1.00000 0.00000) *
                                    3.33e+05) bang&gt;=0.212 3    1 y (0.33333 0.66667)  
                                      6.66e+05) crl.tot&gt;=77.5 2    1 n (0.50000 0.50000)  
                                        1.33e+06) crl.tot&lt; 78.5 1    0 n (1.00000 0.00000) *
                                        1.33e+06) crl.tot&gt;=78.5 1    0 y (0.00000 1.00000) *
                                      6.66e+05) crl.tot&lt; 77.5 1    0 y (0.00000 1.00000) *
                                8.32e+04) crl.tot&lt; 75.5 6    3 n (0.50000 0.50000)  
                                  1.66e+05) bang&lt; 0.272 4    1 n (0.75000 0.25000)  
                                    3.33e+05) crl.tot&lt; 70.5 2    0 n (1.00000 0.00000) *
                                    3.33e+05) crl.tot&gt;=70.5 2    1 n (0.50000 0.50000)  
                                      6.66e+05) crl.tot&gt;=71.5 1    0 n (1.00000 0.00000) *
                                      6.66e+05) crl.tot&lt; 71.5 1    0 y (0.00000 1.00000) *
                                  1.66e+05) bang&gt;=0.272 2    0 y (0.00000 1.00000) *
                            2.08e+04) bang&lt; 0.195 3    1 y (0.33333 0.66667)  
                              4.16e+04) crl.tot&lt; 56.5 1    0 n (1.00000 0.00000) *
                              4.16e+04) crl.tot&gt;=56.5 2    0 y (0.00000 1.00000) *
                        5.20e+03) make&gt;=1.51 1    0 y (0.00000 1.00000) *
                      2.60e+03) crl.tot&lt; 54.5 10    4 y (0.40000 0.60000)  
                        5.20e+03) bang&gt;=0.243 7    3 n (0.57143 0.42857)  
                          1.04e+04) bang&lt; 0.286 2    0 n (1.00000 0.00000) *
                          1.04e+04) bang&gt;=0.286 5    2 y (0.40000 0.60000)  
                            2.08e+04) crl.tot&gt;=53.5 1    0 n (1.00000 0.00000) *
                            2.08e+04) crl.tot&lt; 53.5 4    1 y (0.25000 0.75000)  
                              4.16e+04) crl.tot&lt; 52.5 2    1 n (0.50000 0.50000)  
                                8.32e+04) bang&gt;=0.321 1    0 n (1.00000 0.00000) *
                                8.32e+04) bang&lt; 0.321 1    0 y (0.00000 1.00000) *
                              4.16e+04) crl.tot&gt;=52.5 2    0 y (0.00000 1.00000) *
                        5.20e+03) bang&lt; 0.243 3    0 y (0.00000 1.00000) *
                    1.30e+03) crl.tot&gt;=80.5 7    2 y (0.28571 0.71429)  
                      2.60e+03) crl.tot&gt;=82.5 3    1 n (0.66667 0.33333)  
                        5.20e+03) bang&gt;=0.235 2    0 n (1.00000 0.00000) *
                        5.20e+03) bang&lt; 0.235 1    0 y (0.00000 1.00000) *
                      2.60e+03) crl.tot&lt; 82.5 4    0 y (0.00000 1.00000) *
                  6.51e+02) bang&lt; 0.175 3    0 y (0.00000 1.00000) *
              1.63e+02) bang&gt;=0.406 38   12 y (0.31579 0.68421)  
                3.26e+02) crl.tot&lt; 67.5 18    9 n (0.50000 0.50000)  
                  6.52e+02) bang&lt; 0.448 4    1 n (0.75000 0.25000)  
                    1.30e+03) crl.tot&lt; 55 2    0 n (1.00000 0.00000) *
                    1.30e+03) crl.tot&gt;=55 2    1 n (0.50000 0.50000)  
                      2.61e+03) crl.tot&gt;=58 1    0 n (1.00000 0.00000) *
                      2.61e+03) crl.tot&lt; 58 1    0 y (0.00000 1.00000) *
                  6.53e+02) bang&gt;=0.448 14    6 y (0.42857 0.57143)  
                    1.31e+03) bang&gt;=0.579 4    1 n (0.75000 0.25000)  
                      2.61e+03) crl.tot&gt;=58 3    0 n (1.00000 0.00000) *
                      2.61e+03) crl.tot&lt; 58 1    0 y (0.00000 1.00000) *
                    1.31e+03) bang&lt; 0.579 10    3 y (0.30000 0.70000)  
                      2.61e+03) bang&gt;=0.471 8    3 y (0.37500 0.62500)  
                        5.23e+03) crl.tot&lt; 57 1    0 n (1.00000 0.00000) *
                        5.23e+03) crl.tot&gt;=57 7    2 y (0.28571 0.71429)  
                          1.05e+04) bang&lt; 0.485 1    0 n (1.00000 0.00000) *
                          1.05e+04) bang&gt;=0.485 6    1 y (0.16667 0.83333)  
                            2.09e+04) crl.tot&lt; 63.5 3    1 y (0.33333 0.66667)  
                              4.18e+04) crl.tot&gt;=62 1    0 n (1.00000 0.00000) *
                              4.18e+04) crl.tot&lt; 62 2    0 y (0.00000 1.00000) *
                            2.09e+04) crl.tot&gt;=63.5 3    0 y (0.00000 1.00000) *
                      2.62e+03) bang&lt; 0.471 2    0 y (0.00000 1.00000) *
                3.27e+02) crl.tot&gt;=67.5 20    3 y (0.15000 0.85000)  
                  6.54e+02) crl.tot&gt;=81 1    0 n (1.00000 0.00000) *
                  6.55e+02) crl.tot&lt; 81 19    2 y (0.10526 0.89474)  
                    1.31e+03) crl.tot&gt;=71.5 12    2 y (0.16667 0.83333)  
                      2.62e+03) crl.tot&lt; 72.5 1    0 n (1.00000 0.00000) *
                      2.62e+03) crl.tot&gt;=72.5 11    1 y (0.09091 0.90909)  
                        5.24e+03) bang&lt; 0.464 3    1 y (0.33333 0.66667)  
                          1.05e+04) crl.tot&gt;=78 1    0 n (1.00000 0.00000) *
                          1.05e+04) crl.tot&lt; 78 2    0 y (0.00000 1.00000) *
                        5.24e+03) bang&gt;=0.464 8    0 y (0.00000 1.00000) *
                    1.31e+03) crl.tot&lt; 71.5 7    0 y (0.00000 1.00000) *
          4.10e+01) money&gt;=0.835 10    1 y (0.10000 0.90000)  
            8.20e+01) crl.tot&lt; 39.5 4    1 y (0.25000 0.75000)  
              1.64e+02) crl.tot&gt;=29.5 1    0 n (1.00000 0.00000) *
              1.65e+02) crl.tot&lt; 29.5 3    0 y (0.00000 1.00000) *
            8.30e+01) crl.tot&gt;=39.5 6    0 y (0.00000 1.00000) *
        2.10e+01) bang&gt;=0.774 117   48 y (0.41026 0.58974)  
          4.20e+01) crl.tot&lt; 17 43   12 n (0.72093 0.27907)  
            8.40e+01) bang&lt; 3.96 35    6 n (0.82857 0.17143)  
              1.68e+02) money&lt; 4.54 34    5 n (0.85294 0.14706)  
                3.36e+02) bang&gt;=0.899 29    3 n (0.89655 0.10345)  
                  6.72e+02) bang&lt; 1.55 18    0 n (1.00000 0.00000) *
                  6.73e+02) bang&gt;=1.55 11    3 n (0.72727 0.27273)  
                    1.35e+03) crl.tot&lt; 6.5 5    0 n (1.00000 0.00000) *
                    1.35e+03) crl.tot&gt;=6.5 6    3 n (0.50000 0.50000)  
                      2.69e+03) bang&gt;=1.82 4    1 n (0.75000 0.25000)  
                        5.39e+03) crl.tot&lt; 14.5 3    0 n (1.00000 0.00000) *
                        5.39e+03) crl.tot&gt;=14.5 1    0 y (0.00000 1.00000) *
                      2.70e+03) bang&lt; 1.82 2    0 y (0.00000 1.00000) *
                3.37e+02) bang&lt; 0.899 5    2 n (0.60000 0.40000)  
                  6.74e+02) crl.tot&lt; 10 2    0 n (1.00000 0.00000) *
                  6.75e+02) crl.tot&gt;=10 3    1 y (0.33333 0.66667)  
                    1.35e+03) crl.tot&gt;=13 1    0 n (1.00000 0.00000) *
                    1.35e+03) crl.tot&lt; 13 2    0 y (0.00000 1.00000) *
              1.69e+02) money&gt;=4.54 1    0 y (0.00000 1.00000) *
            8.50e+01) bang&gt;=3.96 8    2 y (0.25000 0.75000)  
              1.70e+02) bang&gt;=8.09 2    0 n (1.00000 0.00000) *
              1.71e+02) bang&lt; 8.09 6    0 y (0.00000 1.00000) *
          4.30e+01) crl.tot&gt;=17 74   17 y (0.22973 0.77027)  
            8.60e+01) bang&gt;=4.89 6    0 n (1.00000 0.00000) *
            8.70e+01) bang&lt; 4.89 68   11 y (0.16176 0.83824)  
              1.74e+02) crl.tot&lt; 35 19    7 y (0.36842 0.63158)  
                3.48e+02) crl.tot&gt;=20 16    7 y (0.43750 0.56250)  
                  6.96e+02) crl.tot&lt; 22.5 2    0 n (1.00000 0.00000) *
                  6.97e+02) crl.tot&gt;=22.5 14    5 y (0.35714 0.64286)  
                    1.39e+03) crl.tot&gt;=25.5 8    4 n (0.50000 0.50000)  
                      2.79e+03) bang&gt;=1.12 3    0 n (1.00000 0.00000) *
                      2.79e+03) bang&lt; 1.12 5    1 y (0.20000 0.80000)  
                        5.58e+03) bang&lt; 0.853 2    1 n (0.50000 0.50000)  
                          1.12e+04) crl.tot&lt; 32.5 1    0 n (1.00000 0.00000) *
                          1.12e+04) crl.tot&gt;=32.5 1    0 y (0.00000 1.00000) *
                        5.58e+03) bang&gt;=0.853 3    0 y (0.00000 1.00000) *
                    1.40e+03) crl.tot&lt; 25.5 6    1 y (0.16667 0.83333)  
                      2.79e+03) bang&lt; 1.02 1    0 n (1.00000 0.00000) *
                      2.79e+03) bang&gt;=1.02 5    0 y (0.00000 1.00000) *
                3.49e+02) crl.tot&lt; 20 3    0 y (0.00000 1.00000) *
              1.75e+02) crl.tot&gt;=35 49    4 y (0.08163 0.91837)  
                3.50e+02) bang&lt; 0.958 12    3 y (0.25000 0.75000)  
                  7.00e+02) bang&gt;=0.953 1    0 n (1.00000 0.00000) *
                  7.01e+02) bang&lt; 0.953 11    2 y (0.18182 0.81818)  
                    1.40e+03) bang&gt;=0.815 8    2 y (0.25000 0.75000)  
                      2.80e+03) crl.tot&lt; 39.5 1    0 n (1.00000 0.00000) *
                      2.80e+03) crl.tot&gt;=39.5 7    1 y (0.14286 0.85714)  
                        5.61e+03) crl.tot&gt;=74 2    1 n (0.50000 0.50000)  
                          1.12e+04) crl.tot&lt; 79 1    0 n (1.00000 0.00000) *
                          1.12e+04) crl.tot&gt;=79 1    0 y (0.00000 1.00000) *
                        5.61e+03) crl.tot&lt; 74 5    0 y (0.00000 1.00000) *
                    1.40e+03) bang&lt; 0.815 3    0 y (0.00000 1.00000) *
                3.51e+02) bang&gt;=0.958 37    1 y (0.02703 0.97297)  
                  7.02e+02) bang&gt;=1.54 18    1 y (0.05556 0.94444)  
                    1.40e+03) bang&lt; 1.55 1    0 n (1.00000 0.00000) *
                    1.40e+03) bang&gt;=1.55 17    0 y (0.00000 1.00000) *
                  7.03e+02) bang&lt; 1.54 19    0 y (0.00000 1.00000) *
      1.10e+01) crl.tot&gt;=85.5 516  121 y (0.23450 0.76550)  
        2.20e+01) bang&lt; 0.196 152   71 y (0.46711 0.53289)  
          4.40e+01) money&lt; 0.04 117   47 n (0.59829 0.40171)  
            8.80e+01) dollar&lt; 0.0085 106   38 n (0.64151 0.35849)  
              1.76e+02) bang&lt; 0.108 15    0 n (1.00000 0.00000) *
              1.77e+02) bang&gt;=0.108 91   38 n (0.58242 0.41758)  
                3.54e+02) crl.tot&gt;=125 58   18 n (0.68966 0.31034)  
                  7.08e+02) n000&lt; 0.36 56   16 n (0.71429 0.28571)  
                    1.42e+03) crl.tot&lt; 324 38    8 n (0.78947 0.21053)  
                      2.83e+03) crl.tot&gt;=234 12    0 n (1.00000 0.00000) *
                      2.83e+03) crl.tot&lt; 234 26    8 n (0.69231 0.30769)  
                        5.67e+03) crl.tot&lt; 188 22    5 n (0.77273 0.22727)  
                          1.13e+04) bang&gt;=0.121 21    4 n (0.80952 0.19048)  
                            2.27e+04) crl.tot&lt; 134 4    0 n (1.00000 0.00000) *
                            2.27e+04) crl.tot&gt;=134 17    4 n (0.76471 0.23529)  
                              4.53e+04) crl.tot&gt;=136 16    3 n (0.81250 0.18750)  
                                9.07e+04) crl.tot&lt; 150 5    0 n (1.00000 0.00000) *
                                9.07e+04) crl.tot&gt;=150 11    3 n (0.72727 0.27273)  
                                  1.81e+05) crl.tot&gt;=152 10    2 n (0.80000 0.20000)  
                                    3.63e+05) crl.tot&gt;=177 4    0 n (1.00000 0.00000) *
                                    3.63e+05) crl.tot&lt; 177 6    2 n (0.66667 0.33333)  
                                      7.25e+05) crl.tot&lt; 174 5    1 n (0.80000 0.20000)  
                                        1.45e+06) crl.tot&lt; 158 2    0 n (1.00000 0.00000) *
                                        1.45e+06) crl.tot&gt;=158 3    1 n (0.66667 0.33333)  
                                          2.90e+06) crl.tot&gt;=161 2    0 n (1.00000 0.00000) *
                                          2.90e+06) crl.tot&lt; 161 1    0 y (0.00000 1.00000) *
                                      7.25e+05) crl.tot&gt;=174 1    0 y (0.00000 1.00000) *
                                  1.81e+05) crl.tot&lt; 152 1    0 y (0.00000 1.00000) *
                              4.53e+04) crl.tot&lt; 136 1    0 y (0.00000 1.00000) *
                          1.13e+04) bang&lt; 0.121 1    0 y (0.00000 1.00000) *
                        5.67e+03) crl.tot&gt;=188 4    1 y (0.25000 0.75000)  
                          1.13e+04) bang&gt;=0.152 1    0 n (1.00000 0.00000) *
                          1.13e+04) bang&lt; 0.152 3    0 y (0.00000 1.00000) *
                    1.42e+03) crl.tot&gt;=324 18    8 n (0.55556 0.44444)  
                      2.83e+03) crl.tot&gt;=664 7    1 n (0.85714 0.14286)  
                        5.67e+03) make&lt; 0.49 6    0 n (1.00000 0.00000) *
                        5.67e+03) make&gt;=0.49 1    0 y (0.00000 1.00000) *
                      2.84e+03) crl.tot&lt; 664 11    4 y (0.36364 0.63636)  
                        5.67e+03) make&gt;=0.05 4    1 n (0.75000 0.25000)  
                          1.13e+04) bang&gt;=0.132 3    0 n (1.00000 0.00000) *
                          1.13e+04) bang&lt; 0.132 1    0 y (0.00000 1.00000) *
                        5.67e+03) make&lt; 0.05 7    1 y (0.14286 0.85714)  
                          1.13e+04) bang&gt;=0.192 1    0 n (1.00000 0.00000) *
                          1.13e+04) bang&lt; 0.192 6    0 y (0.00000 1.00000) *
                  7.09e+02) n000&gt;=0.36 2    0 y (0.00000 1.00000) *
                3.55e+02) crl.tot&lt; 125 33   13 y (0.39394 0.60606)  
                  7.10e+02) bang&gt;=0.18 4    0 n (1.00000 0.00000) *
                  7.11e+02) bang&lt; 0.18 29    9 y (0.31034 0.68966)  
                    1.42e+03) bang&lt; 0.12 11    5 n (0.54545 0.45455)  
                      2.84e+03) bang&gt;=0.113 5    1 n (0.80000 0.20000)  
                        5.69e+03) crl.tot&lt; 99 2    0 n (1.00000 0.00000) *
                        5.69e+03) crl.tot&gt;=99 3    1 n (0.66667 0.33333)  
                          1.14e+04) crl.tot&gt;=112 1    0 n (1.00000 0.00000) *
                          1.14e+04) crl.tot&lt; 112 2    1 n (0.50000 0.50000)  
                            2.28e+04) bang&gt;=0.118 1    0 n (1.00000 0.00000) *
                            2.28e+04) bang&lt; 0.118 1    0 y (0.00000 1.00000) *
                      2.84e+03) bang&lt; 0.113 6    2 y (0.33333 0.66667)  
                        5.69e+03) crl.tot&gt;=92 4    2 n (0.50000 0.50000)  
                          1.14e+04) crl.tot&lt; 104 1    0 n (1.00000 0.00000) *
                          1.14e+04) crl.tot&gt;=104 3    1 y (0.33333 0.66667)  
                            2.28e+04) crl.tot&gt;=114 2    1 n (0.50000 0.50000)  
                              4.55e+04) crl.tot&lt; 116 1    0 n (1.00000 0.00000) *
                              4.55e+04) crl.tot&gt;=116 1    0 y (0.00000 1.00000) *
                            2.28e+04) crl.tot&lt; 114 1    0 y (0.00000 1.00000) *
                        5.69e+03) crl.tot&lt; 92 2    0 y (0.00000 1.00000) *
                    1.42e+03) bang&gt;=0.12 18    3 y (0.16667 0.83333)  
                      2.85e+03) crl.tot&lt; 89 1    0 n (1.00000 0.00000) *
                      2.85e+03) crl.tot&gt;=89 17    2 y (0.11765 0.88235)  
                        5.69e+03) crl.tot&gt;=99.5 9    2 y (0.22222 0.77778)  
                          1.14e+04) crl.tot&lt; 104 1    0 n (1.00000 0.00000) *
                          1.14e+04) crl.tot&gt;=104 8    1 y (0.12500 0.87500)  
                            2.28e+04) bang&gt;=0.166 2    1 n (0.50000 0.50000)  
                              4.56e+04) crl.tot&gt;=116 1    0 n (1.00000 0.00000) *
                              4.56e+04) crl.tot&lt; 116 1    0 y (0.00000 1.00000) *
                            2.28e+04) bang&lt; 0.166 6    0 y (0.00000 1.00000) *
                        5.70e+03) crl.tot&lt; 99.5 8    0 y (0.00000 1.00000) *
            8.90e+01) dollar&gt;=0.0085 11    2 y (0.18182 0.81818)  
              1.78e+02) crl.tot&lt; 264 3    1 n (0.66667 0.33333)  
                3.56e+02) crl.tot&gt;=124 2    0 n (1.00000 0.00000) *
                3.57e+02) crl.tot&lt; 124 1    0 y (0.00000 1.00000) *
              1.79e+02) crl.tot&gt;=264 8    0 y (0.00000 1.00000) *
          4.50e+01) money&gt;=0.04 35    1 y (0.02857 0.97143)  
            9.00e+01) crl.tot&lt; 90.5 1    0 n (1.00000 0.00000) *
            9.10e+01) crl.tot&gt;=90.5 34    0 y (0.00000 1.00000) *
        2.30e+01) bang&gt;=0.196 364   50 y (0.13736 0.86264)  
          4.60e+01) bang&lt; 0.516 183   44 y (0.24044 0.75956)  
            9.20e+01) crl.tot&lt; 180 67   33 y (0.49254 0.50746)  
              1.84e+02) money&lt; 0.22 63   30 n (0.52381 0.47619)  
                3.68e+02) make&gt;=0.065 10    2 n (0.80000 0.20000)  
                  7.36e+02) bang&lt; 0.337 4    0 n (1.00000 0.00000) *
                  7.37e+02) bang&gt;=0.337 6    2 n (0.66667 0.33333)  
                    1.47e+03) bang&gt;=0.405 3    0 n (1.00000 0.00000) *
                    1.48e+03) bang&lt; 0.405 3    1 y (0.33333 0.66667)  
                      2.95e+03) make&gt;=0.72 1    0 n (1.00000 0.00000) *
                      2.95e+03) make&lt; 0.72 2    0 y (0.00000 1.00000) *
                3.69e+02) make&lt; 0.065 53   25 y (0.47170 0.52830)  
                  7.38e+02) crl.tot&lt; 131 31   13 n (0.58065 0.41935)  
                    1.48e+03) n000&lt; 0.155 29   11 n (0.62069 0.37931)  
                      2.95e+03) crl.tot&gt;=108 8    1 n (0.87500 0.12500)  
                        5.90e+03) bang&lt; 0.382 5    0 n (1.00000 0.00000) *
                        5.90e+03) bang&gt;=0.382 3    1 n (0.66667 0.33333)  
                          1.18e+04) bang&gt;=0.402 2    0 n (1.00000 0.00000) *
                          1.18e+04) bang&lt; 0.402 1    0 y (0.00000 1.00000) *
                      2.95e+03) crl.tot&lt; 108 21   10 n (0.52381 0.47619)  
                        5.91e+03) crl.tot&lt; 91.5 4    0 n (1.00000 0.00000) *
                        5.91e+03) crl.tot&gt;=91.5 17    7 y (0.41176 0.58824)  
                          1.18e+04) crl.tot&lt; 106 14    7 n (0.50000 0.50000)  
                            2.36e+04) crl.tot&gt;=97.5 7    2 n (0.71429 0.28571)  
                              4.73e+04) crl.tot&lt; 103 4    0 n (1.00000 0.00000) *
                              4.73e+04) crl.tot&gt;=103 3    1 y (0.33333 0.66667)  
                                9.45e+04) crl.tot&gt;=105 1    0 n (1.00000 0.00000) *
                                9.45e+04) crl.tot&lt; 105 2    0 y (0.00000 1.00000) *
                            2.36e+04) crl.tot&lt; 97.5 7    2 y (0.28571 0.71429)  
                              4.73e+04) bang&lt; 0.201 1    0 n (1.00000 0.00000) *
                              4.73e+04) bang&gt;=0.201 6    1 y (0.16667 0.83333)  
                                9.45e+04) bang&gt;=0.389 2    1 n (0.50000 0.50000)  
                                  1.89e+05) crl.tot&gt;=93 1    0 n (1.00000 0.00000) *
                                  1.89e+05) crl.tot&lt; 93 1    0 y (0.00000 1.00000) *
                                9.45e+04) bang&lt; 0.389 4    0 y (0.00000 1.00000) *
                          1.18e+04) crl.tot&gt;=106 3    0 y (0.00000 1.00000) *
                    1.48e+03) n000&gt;=0.155 2    0 y (0.00000 1.00000) *
                  7.39e+02) crl.tot&gt;=131 22    7 y (0.31818 0.68182)  
                    1.48e+03) crl.tot&gt;=139 16    7 y (0.43750 0.56250)  
                      2.96e+03) bang&lt; 0.287 3    0 n (1.00000 0.00000) *
                      2.96e+03) bang&gt;=0.287 13    4 y (0.30769 0.69231)  
                        5.91e+03) crl.tot&gt;=176 1    0 n (1.00000 0.00000) *
                        5.92e+03) crl.tot&lt; 176 12    3 y (0.25000 0.75000)  
                          1.18e+04) crl.tot&lt; 158 4    2 n (0.50000 0.50000)  
                            2.37e+04) bang&gt;=0.329 2    0 n (1.00000 0.00000) *
                            2.37e+04) bang&lt; 0.329 2    0 y (0.00000 1.00000) *
                          1.18e+04) crl.tot&gt;=158 8    1 y (0.12500 0.87500)  
                            2.37e+04) bang&lt; 0.303 2    1 n (0.50000 0.50000)  
                              4.73e+04) crl.tot&lt; 168 1    0 n (1.00000 0.00000) *
                              4.73e+04) crl.tot&gt;=168 1    0 y (0.00000 1.00000) *
                            2.37e+04) bang&gt;=0.303 6    0 y (0.00000 1.00000) *
                    1.48e+03) crl.tot&lt; 139 6    0 y (0.00000 1.00000) *
              1.85e+02) money&gt;=0.22 4    0 y (0.00000 1.00000) *
            9.30e+01) crl.tot&gt;=180 116   11 y (0.09483 0.90517)  
              1.86e+02) money&lt; 0.045 77   11 y (0.14286 0.85714)  
                3.72e+02) dollar&gt;=0.0475 1    0 n (1.00000 0.00000) *
                3.73e+02) dollar&lt; 0.0475 76   10 y (0.13158 0.86842)  
                  7.46e+02) bang&lt; 0.474 61   10 y (0.16393 0.83607)  
                    1.49e+03) crl.tot&lt; 788 50   10 y (0.20000 0.80000)  
                      2.98e+03) crl.tot&gt;=584 2    0 n (1.00000 0.00000) *
                      2.98e+03) crl.tot&lt; 584 48    8 y (0.16667 0.83333)  
                        5.97e+03) bang&gt;=0.239 31    8 y (0.25806 0.74194)  
                          1.19e+04) bang&lt; 0.346 14    6 y (0.42857 0.57143)  
                            2.39e+04) bang&gt;=0.332 2    0 n (1.00000 0.00000) *
                            2.39e+04) bang&lt; 0.332 12    4 y (0.33333 0.66667)  
                              4.78e+04) bang&lt; 0.241 1    0 n (1.00000 0.00000) *
                              4.78e+04) bang&gt;=0.241 11    3 y (0.27273 0.72727)  
                                9.55e+04) bang&gt;=0.268 7    3 y (0.42857 0.57143)  
                                  1.91e+05) bang&lt; 0.308 4    1 n (0.75000 0.25000)  
                                    3.82e+05) crl.tot&gt;=320 2    0 n (1.00000 0.00000) *
                                    3.82e+05) crl.tot&lt; 320 2    1 n (0.50000 0.50000)  
                                      7.64e+05) crl.tot&lt; 302 1    0 n (1.00000 0.00000) *
                                      7.64e+05) crl.tot&gt;=302 1    0 y (0.00000 1.00000) *
                                  1.91e+05) bang&gt;=0.308 3    0 y (0.00000 1.00000) *
                                9.55e+04) bang&lt; 0.268 4    0 y (0.00000 1.00000) *
                          1.19e+04) bang&gt;=0.346 17    2 y (0.11765 0.88235)  
                            2.39e+04) bang&gt;=0.436 5    2 y (0.40000 0.60000)  
                              4.78e+04) crl.tot&lt; 355 3    1 n (0.66667 0.33333)  
                                9.55e+04) crl.tot&gt;=236 2    0 n (1.00000 0.00000) *
                                9.55e+04) crl.tot&lt; 236 1    0 y (0.00000 1.00000) *
                              4.78e+04) crl.tot&gt;=355 2    0 y (0.00000 1.00000) *
                            2.39e+04) bang&lt; 0.436 12    0 y (0.00000 1.00000) *
                        5.97e+03) bang&lt; 0.239 17    0 y (0.00000 1.00000) *
                    1.49e+03) crl.tot&gt;=788 11    0 y (0.00000 1.00000) *
                  7.47e+02) bang&gt;=0.474 15    0 y (0.00000 1.00000) *
              1.87e+02) money&gt;=0.045 39    0 y (0.00000 1.00000) *
          4.70e+01) bang&gt;=0.516 181    6 y (0.03315 0.96685)  
            9.40e+01) make&gt;=0.685 6    2 y (0.33333 0.66667)  
              1.88e+02) money&lt; 0.355 3    1 n (0.66667 0.33333)  
                3.76e+02) crl.tot&gt;=116 2    0 n (1.00000 0.00000) *
                3.77e+02) crl.tot&lt; 116 1    0 y (0.00000 1.00000) *
              1.89e+02) money&gt;=0.355 3    0 y (0.00000 1.00000) *
            9.50e+01) make&lt; 0.685 175    4 y (0.02286 0.97714)  
              1.90e+02) dollar&gt;=0.049 5    1 y (0.20000 0.80000)  
                3.80e+02) crl.tot&gt;=630 2    1 n (0.50000 0.50000)  
                  7.60e+02) crl.tot&lt; 648 1    0 n (1.00000 0.00000) *
                  7.61e+02) crl.tot&gt;=648 1    0 y (0.00000 1.00000) *
                3.81e+02) crl.tot&lt; 630 3    0 y (0.00000 1.00000) *
              1.91e+02) dollar&lt; 0.049 170    3 y (0.01765 0.98235)  
                3.82e+02) crl.tot&lt; 142 66    3 y (0.04545 0.95455)  
                  7.64e+02) crl.tot&gt;=142 1    0 n (1.00000 0.00000) *
                  7.65e+02) crl.tot&lt; 142 65    2 y (0.03077 0.96923)  
                    1.53e+03) crl.tot&gt;=135 6    1 y (0.16667 0.83333)  
                      3.06e+03) crl.tot&lt; 136 1    0 n (1.00000 0.00000) *
                      3.06e+03) crl.tot&gt;=136 5    0 y (0.00000 1.00000) *
                    1.53e+03) crl.tot&lt; 135 59    1 y (0.01695 0.98305)  
                      3.06e+03) crl.tot&lt; 104 23    1 y (0.04348 0.95652)  
                        6.12e+03) crl.tot&gt;=102 1    0 n (1.00000 0.00000) *
                        6.12e+03) crl.tot&lt; 102 22    0 y (0.00000 1.00000) *
                      3.06e+03) crl.tot&gt;=104 36    0 y (0.00000 1.00000) *
                3.83e+02) crl.tot&gt;=142 104    0 y (0.00000 1.00000) *
  3.00e+00) dollar&gt;=0.0555 1130  133 y (0.11770 0.88230)  
    6.00e+00) bang&lt; 0.0495 235   89 y (0.37872 0.62128)  
      1.20e+01) money&lt; 0.025 141   59 n (0.58156 0.41844)  
        2.40e+01) n000&lt; 0.465 126   44 n (0.65079 0.34921)  
          4.80e+01) dollar&lt; 0.167 70   11 n (0.84286 0.15714)  
            9.60e+01) crl.tot&lt; 108 19    0 n (1.00000 0.00000) *
            9.70e+01) crl.tot&gt;=108 51   11 n (0.78431 0.21569)  
              1.94e+02) make&lt; 0.23 48    8 n (0.83333 0.16667)  
                3.88e+02) crl.tot&gt;=116 42    4 n (0.90476 0.09524)  
                  7.76e+02) crl.tot&gt;=302 27    0 n (1.00000 0.00000) *
                  7.77e+02) crl.tot&lt; 302 15    4 n (0.73333 0.26667)  
                    1.55e+03) crl.tot&lt; 274 13    2 n (0.84615 0.15385)  
                      3.11e+03) dollar&gt;=0.066 12    1 n (0.91667 0.08333)  
                        6.22e+03) dollar&gt;=0.0905 9    0 n (1.00000 0.00000) *
                        6.22e+03) dollar&lt; 0.0905 3    1 n (0.66667 0.33333)  
                          1.24e+04) dollar&lt; 0.087 2    0 n (1.00000 0.00000) *
                          1.24e+04) dollar&gt;=0.087 1    0 y (0.00000 1.00000) *
                      3.11e+03) dollar&lt; 0.066 1    0 y (0.00000 1.00000) *
                    1.56e+03) crl.tot&gt;=274 2    0 y (0.00000 1.00000) *
                3.89e+02) crl.tot&lt; 116 6    2 y (0.33333 0.66667)  
                  7.78e+02) dollar&lt; 0.096 2    0 n (1.00000 0.00000) *
                  7.79e+02) dollar&gt;=0.096 4    0 y (0.00000 1.00000) *
              1.95e+02) make&gt;=0.23 3    0 y (0.00000 1.00000) *
          4.90e+01) dollar&gt;=0.167 56   23 y (0.41071 0.58929)  
            9.80e+01) dollar&gt;=0.193 45   22 n (0.51111 0.48889)  
              1.96e+02) dollar&lt; 1.01 38   16 n (0.57895 0.42105)  
                3.92e+02) dollar&gt;=0.359 17    4 n (0.76471 0.23529)  
                  7.84e+02) crl.tot&lt; 21 3    0 n (1.00000 0.00000) *
                  7.85e+02) crl.tot&gt;=21 14    4 n (0.71429 0.28571)  
                    1.57e+03) crl.tot&gt;=35.5 11    2 n (0.81818 0.18182)  
                      3.14e+03) crl.tot&lt; 82 5    0 n (1.00000 0.00000) *
                      3.14e+03) crl.tot&gt;=82 6    2 n (0.66667 0.33333)  
                        6.28e+03) dollar&lt; 0.607 3    0 n (1.00000 0.00000) *
                        6.28e+03) dollar&gt;=0.607 3    1 y (0.33333 0.66667)  
                          1.26e+04) dollar&gt;=0.774 1    0 n (1.00000 0.00000) *
                          1.26e+04) dollar&lt; 0.774 2    0 y (0.00000 1.00000) *
                    1.57e+03) crl.tot&lt; 35.5 3    1 y (0.33333 0.66667)  
                      3.14e+03) crl.tot&lt; 29 2    1 n (0.50000 0.50000)  
                        6.28e+03) dollar&gt;=0.601 1    0 n (1.00000 0.00000) *
                        6.28e+03) dollar&lt; 0.601 1    0 y (0.00000 1.00000) *
                      3.14e+03) crl.tot&gt;=29 1    0 y (0.00000 1.00000) *
                3.93e+02) dollar&lt; 0.359 21    9 y (0.42857 0.57143)  
                  7.86e+02) dollar&lt; 0.211 3    0 n (1.00000 0.00000) *
                  7.87e+02) dollar&gt;=0.211 18    6 y (0.33333 0.66667)  
                    1.57e+03) dollar&lt; 0.335 14    6 y (0.42857 0.57143)  
                      3.15e+03) make&lt; 0.145 12    6 n (0.50000 0.50000)  
                        6.30e+03) dollar&gt;=0.217 8    3 n (0.62500 0.37500)  
                          1.26e+04) crl.tot&gt;=23.5 7    2 n (0.71429 0.28571)  
                            2.52e+04) crl.tot&lt; 178 6    1 n (0.83333 0.16667)  
                              5.04e+04) crl.tot&gt;=64 3    0 n (1.00000 0.00000) *
                              5.04e+04) crl.tot&lt; 64 3    1 n (0.66667 0.33333)  
                                1.01e+05) crl.tot&lt; 53 2    0 n (1.00000 0.00000) *
                                1.01e+05) crl.tot&gt;=53 1    0 y (0.00000 1.00000) *
                            2.52e+04) crl.tot&gt;=178 1    0 y (0.00000 1.00000) *
                          1.26e+04) crl.tot&lt; 23.5 1    0 y (0.00000 1.00000) *
                        6.30e+03) dollar&lt; 0.217 4    1 y (0.25000 0.75000)  
                          1.26e+04) crl.tot&gt;=218 1    0 n (1.00000 0.00000) *
                          1.26e+04) crl.tot&lt; 218 3    0 y (0.00000 1.00000) *
                      3.15e+03) make&gt;=0.145 2    0 y (0.00000 1.00000) *
                    1.58e+03) dollar&gt;=0.335 4    0 y (0.00000 1.00000) *
              1.97e+02) dollar&gt;=1.01 7    1 y (0.14286 0.85714)  
                3.94e+02) dollar&gt;=1.82 3    1 y (0.33333 0.66667)  
                  7.88e+02) crl.tot&gt;=239 1    0 n (1.00000 0.00000) *
                  7.89e+02) crl.tot&lt; 239 2    0 y (0.00000 1.00000) *
                3.95e+02) dollar&lt; 1.82 4    0 y (0.00000 1.00000) *
            9.90e+01) dollar&lt; 0.193 11    0 y (0.00000 1.00000) *
        2.50e+01) n000&gt;=0.465 15    0 y (0.00000 1.00000) *
      1.30e+01) money&gt;=0.025 94    7 y (0.07447 0.92553)  
        2.60e+01) crl.tot&lt; 50 2    0 n (1.00000 0.00000) *
        2.70e+01) crl.tot&gt;=50 92    5 y (0.05435 0.94565)  
          5.40e+01) dollar&gt;=0.363 1    0 n (1.00000 0.00000) *
          5.50e+01) dollar&lt; 0.363 91    4 y (0.04396 0.95604)  
            1.10e+02) dollar&lt; 0.132 15    4 y (0.26667 0.73333)  
              2.20e+02) dollar&gt;=0.0995 4    1 n (0.75000 0.25000)  
                4.40e+02) n000&lt; 0.745 3    0 n (1.00000 0.00000) *
                4.41e+02) n000&gt;=0.745 1    0 y (0.00000 1.00000) *
              2.21e+02) dollar&lt; 0.0995 11    1 y (0.09091 0.90909)  
                4.42e+02) bang&gt;=0.0285 1    0 n (1.00000 0.00000) *
                4.43e+02) bang&lt; 0.0285 10    0 y (0.00000 1.00000) *
            1.11e+02) dollar&gt;=0.132 76    0 y (0.00000 1.00000) *
    7.00e+00) bang&gt;=0.0495 895   44 y (0.04916 0.95084)  
      1.40e+01) crl.tot&lt; 27.5 2    0 n (1.00000 0.00000) *
      1.50e+01) crl.tot&gt;=27.5 893   42 y (0.04703 0.95297)  
        3.00e+01) bang&lt; 0.376 412   38 y (0.09223 0.90777)  
          6.00e+01) money&lt; 0.025 201   32 y (0.15920 0.84080)  
            1.20e+02) n000&lt; 1.01 162   32 y (0.19753 0.80247)  
              2.40e+02) bang&lt; 0.143 51   17 y (0.33333 0.66667)  
                4.80e+02) bang&gt;=0.0705 35   16 y (0.45714 0.54286)  
                  9.60e+02) dollar&lt; 0.0825 11    2 n (0.81818 0.18182)  
                    1.92e+03) dollar&gt;=0.0585 9    0 n (1.00000 0.00000) *
                    1.92e+03) dollar&lt; 0.0585 2    0 y (0.00000 1.00000) *
                  9.61e+02) dollar&gt;=0.0825 24    7 y (0.29167 0.70833)  
                    1.92e+03) dollar&lt; 0.287 18    7 y (0.38889 0.61111)  
                      3.84e+03) dollar&gt;=0.185 5    0 n (1.00000 0.00000) *
                      3.84e+03) dollar&lt; 0.185 13    2 y (0.15385 0.84615)  
                        7.69e+03) crl.tot&gt;=746 1    0 n (1.00000 0.00000) *
                        7.69e+03) crl.tot&lt; 746 12    1 y (0.08333 0.91667)  
                          1.54e+04) bang&lt; 0.079 1    0 n (1.00000 0.00000) *
                          1.54e+04) bang&gt;=0.079 11    0 y (0.00000 1.00000) *
                    1.92e+03) dollar&gt;=0.287 6    0 y (0.00000 1.00000) *
                4.81e+02) bang&lt; 0.0705 16    1 y (0.06250 0.93750)  
                  9.62e+02) crl.tot&gt;=566 3    1 y (0.33333 0.66667)  
                    1.92e+03) crl.tot&lt; 881 1    0 n (1.00000 0.00000) *
                    1.92e+03) crl.tot&gt;=881 2    0 y (0.00000 1.00000) *
                  9.63e+02) crl.tot&lt; 566 13    0 y (0.00000 1.00000) *
              2.41e+02) bang&gt;=0.143 111   15 y (0.13514 0.86486)  
                4.82e+02) bang&gt;=0.276 43   13 y (0.30233 0.69767)  
                  9.64e+02) dollar&gt;=0.177 11    3 n (0.72727 0.27273)  
                    1.93e+03) bang&lt; 0.362 9    1 n (0.88889 0.11111)  
                      3.86e+03) crl.tot&lt; 104 6    0 n (1.00000 0.00000) *
                      3.86e+03) crl.tot&gt;=104 3    1 n (0.66667 0.33333)  
                        7.71e+03) crl.tot&gt;=120 2    0 n (1.00000 0.00000) *
                        7.72e+03) crl.tot&lt; 120 1    0 y (0.00000 1.00000) *
                    1.93e+03) bang&gt;=0.362 2    0 y (0.00000 1.00000) *
                  9.65e+02) dollar&lt; 0.177 32    5 y (0.15625 0.84375)  
                    1.93e+03) crl.tot&lt; 61.5 6    3 n (0.50000 0.50000)  
                      3.86e+03) make&lt; 0.37 3    0 n (1.00000 0.00000) *
                      3.86e+03) make&gt;=0.37 3    0 y (0.00000 1.00000) *
                    1.93e+03) crl.tot&gt;=61.5 26    2 y (0.07692 0.92308)  
                      3.86e+03) bang&gt;=0.373 1    0 n (1.00000 0.00000) *
                      3.86e+03) bang&lt; 0.373 25    1 y (0.04000 0.96000)  
                        7.73e+03) crl.tot&lt; 101 7    1 y (0.14286 0.85714)  
                          1.55e+04) crl.tot&gt;=82 1    0 n (1.00000 0.00000) *
                          1.55e+04) crl.tot&lt; 82 6    0 y (0.00000 1.00000) *
                        7.73e+03) crl.tot&gt;=101 18    0 y (0.00000 1.00000) *
                4.83e+02) bang&lt; 0.276 68    2 y (0.02941 0.97059)  
                  9.66e+02) crl.tot&lt; 55.5 6    1 y (0.16667 0.83333)  
                    1.93e+03) crl.tot&gt;=51 1    0 n (1.00000 0.00000) *
                    1.93e+03) crl.tot&lt; 51 5    0 y (0.00000 1.00000) *
                  9.67e+02) crl.tot&gt;=55.5 62    1 y (0.01613 0.98387)  
                    1.93e+03) dollar&gt;=0.331 14    1 y (0.07143 0.92857)  
                      3.87e+03) dollar&lt; 0.339 1    0 n (1.00000 0.00000) *
                      3.87e+03) dollar&gt;=0.339 13    0 y (0.00000 1.00000) *
                    1.94e+03) dollar&lt; 0.331 48    0 y (0.00000 1.00000) *
            1.21e+02) n000&gt;=1.01 39    0 y (0.00000 1.00000) *
          6.10e+01) money&gt;=0.025 211    6 y (0.02844 0.97156)  
            1.22e+02) crl.tot&lt; 162 31    5 y (0.16129 0.83871)  
              2.44e+02) crl.tot&gt;=105 12    5 y (0.41667 0.58333)  
                4.88e+02) bang&gt;=0.214 3    0 n (1.00000 0.00000) *
                4.89e+02) bang&lt; 0.214 9    2 y (0.22222 0.77778)  
                  9.78e+02) money&gt;=0.655 3    1 n (0.66667 0.33333) *
                  9.79e+02) money&lt; 0.655 6    0 y (0.00000 1.00000) *
              2.45e+02) crl.tot&lt; 105 19    0 y (0.00000 1.00000) *
            1.23e+02) crl.tot&gt;=162 180    1 y (0.00556 0.99444)  
              2.46e+02) bang&gt;=0.371 4    1 y (0.25000 0.75000)  
                4.92e+02) dollar&gt;=0.21 1    0 n (1.00000 0.00000) *
                4.93e+02) dollar&lt; 0.21 3    0 y (0.00000 1.00000) *
              2.47e+02) bang&lt; 0.371 176    0 y (0.00000 1.00000) *
        3.10e+01) bang&gt;=0.376 481    4 y (0.00832 0.99168)  
          6.20e+01) crl.tot&lt; 35 4    1 y (0.25000 0.75000)  
            1.24e+02) crl.tot&gt;=33.5 1    0 n (1.00000 0.00000) *
            1.25e+02) crl.tot&lt; 33.5 3    0 y (0.00000 1.00000) *
          6.30e+01) crl.tot&gt;=35 477    3 y (0.00629 0.99371)  
            1.26e+02) money&gt;=1.04 30    1 y (0.03333 0.96667)  
              2.52e+02) money&lt; 1.06 3    1 y (0.33333 0.66667)  
                5.04e+02) dollar&lt; 0.138 1    0 n (1.00000 0.00000) *
                5.05e+02) dollar&gt;=0.138 2    0 y (0.00000 1.00000) *
              2.53e+02) money&gt;=1.06 27    0 y (0.00000 1.00000) *
            1.27e+02) money&lt; 1.04 447    2 y (0.00447 0.99553)  
              2.54e+02) bang&lt; 0.407 32    1 y (0.03125 0.96875)  
                5.08e+02) bang&gt;=0.406 2    1 n (0.50000 0.50000)  
                  1.02e+03) crl.tot&lt; 191 1    0 n (1.00000 0.00000) *
                  1.02e+03) crl.tot&gt;=191 1    0 y (0.00000 1.00000) *
                5.09e+02) bang&lt; 0.406 30    0 y (0.00000 1.00000) *
              2.55e+02) bang&gt;=0.407 415    1 y (0.00241 0.99759)  
                5.10e+02) dollar&lt; 0.16 128    1 y (0.00781 0.99219)  
                  1.02e+03) dollar&gt;=0.159 1    0 n (1.00000 0.00000) *
                  1.02e+03) dollar&lt; 0.159 127    0 y (0.00000 1.00000) *
                5.11e+02) dollar&gt;=0.16 287    0 y (0.00000 1.00000) *</code></pre>
</div>
</div>
<p>Training error on tree with pre-pruning</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(tree_default, spam) <span class="sc">|&gt;</span> <span class="fu">head</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      n     y
1 0.234 0.766
2 0.118 0.882
3 0.118 0.882
4 0.234 0.766
5 0.234 0.766
6 0.898 0.102</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(tree_default, spam, <span class="at">type=</span><span class="st">"class"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 2 3 4 5 6 
y y y y y n 
Levels: n y</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>confusion_table <span class="ot">&lt;-</span> <span class="fu">with</span>(spam, <span class="fu">table</span>(yesno, pred))</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>confusion_table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     pred
yesno    n    y
    n 2517  271
    y  364 1449</code></pre>
</div>
</div>
<p>Get correct prediction values</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>correct <span class="ot">&lt;-</span> confusion_table <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>correct</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3966</code></pre>
</div>
</div>
<p>Get error in predictions</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>error <span class="ot">&lt;-</span> confusion_table <span class="sc">|&gt;</span> <span class="fu">sum</span>() <span class="sc">-</span> correct</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>error</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 635</code></pre>
</div>
</div>
<p>Accuracy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> correct <span class="sc">/</span> (correct <span class="sc">+</span> error)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>accuracy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.862</code></pre>
</div>
</div>
<p>Use a function for accuracy</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="cf">function</span>(truth, prediction) {</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>    tbl <span class="ot">&lt;-</span> <span class="fu">table</span>(truth, prediction)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">diag</span>(tbl))<span class="sc">/</span><span class="fu">sum</span>(tbl)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno), pred)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.862</code></pre>
</div>
</div>
<p>Training error of the full tree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">accuracy</span>(spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno), </span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">predict</span>(tree_full, spam, <span class="at">type =</span> <span class="st">"class"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.97</code></pre>
</div>
</div>
<p>Get a confusion table with more statistics (using caret)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred, </span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">reference =</span> spam <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction    n    y
         n 2517  364
         y  271 1449
                                        
               Accuracy : 0.862         
                 95% CI : (0.852, 0.872)
    No Information Rate : 0.606         
    P-Value [Acc &gt; NIR] : &lt; 2e-16       
                                        
                  Kappa : 0.708         
                                        
 Mcnemar's Test P-Value : 0.000261      
                                        
            Sensitivity : 0.903         
            Specificity : 0.799         
         Pos Pred Value : 0.874         
         Neg Pred Value : 0.842         
             Prevalence : 0.606         
         Detection Rate : 0.547         
   Detection Prevalence : 0.626         
      Balanced Accuracy : 0.851         
                                        
       'Positive' Class : n             
                                        </code></pre>
</div>
</div>
</section>
<section id="make-predictions-for-new-data" class="level3">
<h3 class="anchored" data-anchor-id="make-predictions-for-new-data"><strong>Make Predictions for New Data</strong></h3>
<p>Make up my own email: An email with funky characteristics</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>my_email <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">crl.tot =</span> <span class="dv">300</span>, <span class="at">dollar =</span> <span class="fl">0.010</span>, <span class="at">bang =</span> <span class="fl">0.020</span>,</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">money =</span> <span class="fl">0.43</span>, <span class="at">n000 =</span> <span class="fl">0.000</span>, <span class="at">make =</span> <span class="fl">0.34</span>,<span class="at">yesno =</span> <span class="cn">NA</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Make a prediction using the default tree</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">predict</span>(tree_default , my_email, <span class="at">type =</span> <span class="st">"class"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 
n 
Levels: n y</code></pre>
</div>
</div>
</section>
</section>
<section id="model-evaluation-with-caret" class="level1">
<h1><strong>Model Evaluation with Caret</strong></h1>
<p>The package <a href="https://topepo.github.io/caret/"><code>caret</code></a> makes preparing training sets, building classification (and regression) models and evaluation easier.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(caret)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Cross-validation runs are independent and can be done faster in parallel. To enable multi-core support, <code>caret</code> uses the package <code>foreach</code> and you need to load a <code>do</code> backend.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Linux backend</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">require</span>(doMC))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"doMC"</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: doMC</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: foreach</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'foreach'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:purrr':

    accumulate, when</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: iterators</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: parallel</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(doMC)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="fu">registerDoMC</span>(<span class="at">cores =</span> <span class="dv">4</span>)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="fu">getDoParWorkers</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4</code></pre>
</div>
</div>
<p>Set random number generator seed to make results reproducible</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">2000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="hold-out-test-data" class="level3">
<h3 class="anchored" data-anchor-id="hold-out-test-data"><strong>Hold out Test Data</strong></h3>
<p>Test data is not used in the model building process and set aside purely for testing the model. Here, we partition data the 80% training and 20% testing.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>inTrain <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(<span class="at">y =</span> spam<span class="sc">$</span>yesno, <span class="at">p =</span> .<span class="dv">8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>spam_train <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> <span class="fu">slice</span>(inTrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Slicing with a 1-column matrix was deprecated in dplyr 1.1.0.</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>spam_test <span class="ot">&lt;-</span> spam <span class="sc">|&gt;</span> <span class="fu">slice</span>(<span class="sc">-</span>inTrain)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="learn-a-model-and-tune-hyperparameters-on-the-training-data" class="level3">
<h3 class="anchored" data-anchor-id="learn-a-model-and-tune-hyperparameters-on-the-training-data"><strong>Learn a Model and Tune Hyperparameters on the Training Data</strong></h3>
<p>The package <code>caret</code> combines training and validation for hyperparameter tuning into a single function called <code>train()</code>. It internally splits the data into training and validation sets and thus will provide you with error estimates for different hyperparameter settings. <code>trainControl</code> is used to choose how testing is performed.</p>
<p>For rpart, train tries to tune the <code>cp</code> parameter (tree complexity) using accuracy to chose the best model. I set <code>minsplit</code> to 2 since we have not much data. <strong>Note:</strong> Parameters used for tuning (in this case <code>cp</code>) need to be set using a data.frame in the argument <code>tuneGrid</code>! Setting it in control will be ignored.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> .,</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> _ ,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>),</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">tuneLength =</span> <span class="dv">5</span>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

3682 samples
   6 predictor
   2 classes: 'n', 'y' 

No pre-processing
Resampling: Cross-Validated (10 fold) 
Summary of sample sizes: 3313, 3314, 3314, 3314, 3314, 3314, ... 
Resampling results across tuning parameters:

  cp       Accuracy  Kappa
  0.00551  0.859     0.699
  0.00586  0.856     0.694
  0.01068  0.847     0.674
  0.07788  0.798     0.560
  0.47071  0.673     0.195

Accuracy was used to select the optimal model using the largest value.
The final value used for the model was cp = 0.00551.</code></pre>
</div>
</div>
<p><strong>Note:</strong> Train has built 10 trees using the training folds for each value of <code>cp</code> and the reported values for accuracy and Kappa are the averages on the validation folds.</p>
<p>A model using the best tuning parameters and using all the data supplied to <code>train()</code> is available as <code>fit$finalModel</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit<span class="sc">$</span>finalModel, <span class="at">extra =</span> <span class="dv">2</span>,</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">box.palette =</span> <span class="fu">list</span>(<span class="st">"Bu"</span>, <span class="st">"Or"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>caret also computes variable importance. By default it uses competing splits (splits which would be runners up, but do not get chosen by the tree) for rpart models (see <code>? varImp</code>). Toothed is the runner up for many splits, but it never gets chosen!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">varImp</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rpart variable importance

        Overall
bang      100.0
dollar     73.2
money      66.1
crl.tot    56.1
n000       48.8
make        0.0</code></pre>
</div>
</div>
<p>Here is the variable importance without competing splits.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>imp <span class="ot">&lt;-</span> <span class="fu">varImp</span>(fit, <span class="at">compete =</span> <span class="cn">FALSE</span>)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>imp</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>rpart variable importance

        Overall
dollar   100.00
bang      45.72
crl.tot   17.96
money      2.28
make       0.00
n000       0.00</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(imp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><strong>Note:</strong> Not all models provide a variable importance function. In this case caret might calculate the variable importance by itself and ignore the model (see <code>? varImp</code>)!</p>
</section>
</section>
<section id="testing-confusion-matrix-and-confidence-interval-for-accuracy" class="level1">
<h1><strong>Testing: Confusion Matrix and Confidence Interval for Accuracy</strong></h1>
<p>Use the best model on the test data</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(fit, <span class="at">newdata =</span> spam_test)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>pred</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] y y n y y y y y y y y y y y y n y y y n n y n y y y y y y y n y y n n y y
 [38] y y n y y y y y n y n y y y y y y y y n n y y y y y y y y y y y y y y y n
 [75] n y y n y y y n y y y y y n y n n y n y y y n y y y y y y y y n y y n y y
[112] n y y y n y y y n y y y y y y y y y y y y n y y n y y n y y y y y y y y n
[149] y y y y y y y n y y y n y y y y y n y y y n y n y y n n y y y y y y y y y
[186] y n n n n y y y y y y y y y y n y y y y y y y y y y y y y y y y y y n n y
[223] y y y y y y n y y y y y y y y y y y y n n y y y y y y y n n y y y y n y y
[260] y y y y y n y y y y n n y y y y n y y y n n y n n y y y y y y y n n y n y
[297] y y y y y y y y y y n y n y n n y n y y y y y y y y y y n y n y y y n y y
[334] y y y n y n y n y y y y n y y y y y y y y y y y n y n y n n n n n n n n n
[371] y n n n n n n n n y n n n n n n n n n n n n n n n n n n n n y n n n n n y
[408] n n y n n n n n n n n n n n y n n n y n n n n n n n n n y n n n n n n n n
[445] y n n n n n n n n n n n n n n y n n n n n n n n y n n n n n n n n n y n n
[482] n n n n n n n n n n n n y n n n n n n n n n n n n n n n n n n n n n n y n
[519] y n n n n n n y n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[556] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n y n n n n n n y
[593] n n n n n n n y n n n n n n n n n n y n n n n n n n n n n n n n n n n n n
[630] n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[667] n n n n n n n n n y n n n n n n n n n n n n n n y y n n n n n n n n n n n
[704] n y n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n n
[741] n n n n n n n n n n n n n n n n n n n n n n n n n n y n y n n n n n n n n
[778] n n n n n n n n n n n n n n y n n n n n n n n n n n n n n n n n n n y n y
[815] n n n n n n n n n n n n n n n n n n n y n n n n n n n n n n y n n n n n n
[852] n n n n y n n n n n y n n y n n n n n n n n n y n n n n n n y n n y n n y
[889] n n y n n n n y n n n n n y n n n n n n n n n n n n n n n n n
Levels: n y</code></pre>
</div>
</div>
<p>Caret’s <code>confusionMatrix()</code> function calculates accuracy, confidence intervals, kappa and many more evaluation metrics. You need to use separate test data to create a confusion matrix based on the generalization error.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(<span class="at">data =</span> pred, </span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>                <span class="at">ref =</span> spam_test <span class="sc">|&gt;</span> <span class="fu">pull</span>(yesno))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction   n   y
         n 516  77
         y  41 285
                                        
               Accuracy : 0.872         
                 95% CI : (0.848, 0.893)
    No Information Rate : 0.606         
    P-Value [Acc &gt; NIR] : &lt; 2e-16       
                                        
                  Kappa : 0.726         
                                        
 Mcnemar's Test P-Value : 0.00127       
                                        
            Sensitivity : 0.926         
            Specificity : 0.787         
         Pos Pred Value : 0.870         
         Neg Pred Value : 0.874         
             Prevalence : 0.606         
         Detection Rate : 0.561         
   Detection Prevalence : 0.645         
      Balanced Accuracy : 0.857         
                                        
       'Positive' Class : n             
                                        </code></pre>
</div>
</div>
<p><strong>Some notes</strong></p>
<ul>
<li><p>Many classification algorithms and <code>train</code> in caret do not deal well with missing values. If your classification model can deal with missing values (e.g., <code>rpart</code>) then use <code>na.action = na.pass</code> when you call <code>train</code> and <code>predict</code>. Otherwise, you need to remove observations with missing values with <code>na.omit</code> or use imputation to replace the missing values before you train the model. Make sure that you still have enough observations left.</p></li>
<li><p>Make sure that nominal variables are coded as factors.</p></li>
<li><p>The class variable for train in caret cannot have level names that are keywords in R (e.g., <code>TRUE</code> and <code>FALSE</code>). Rename them to, for example, “yes” and “no.”</p></li>
<li><p>Make sure that nominal variables (factors) have examples for all possible values. Some methods might have problems with variable values without examples. You can drop empty levels using <code>droplevels</code> or <code>factor</code>.</p></li>
<li><p>Sampling in train might create a sample that does not contain examples for all values in a nominal (factor) variable. You will get an error message. This most likely happens for variables which have one very rare value. You may have to remove the variable.</p></li>
</ul>
</section>
<section id="model-comparison" class="level1">
<h1><strong>Model Comparison</strong></h1>
<p>We will compare decision trees with a k-nearest neighbors (kNN) classifier. We will create fixed sampling scheme (10-folds) so we compare the different models using exactly the same folds. It is specified as <code>trControl</code> during training.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>train_index <span class="ot">&lt;-</span> <span class="fu">createFolds</span>(spam_train<span class="sc">$</span>yesno, <span class="at">k =</span> <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Build models</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>rpartFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> .,</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index)</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Note:</strong> for kNN we ask <code>train</code> to scale the data using <code>preProcess = "scale"</code>. Logicals will be used as 0-1 variables in Euclidean distance calculation.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>knnFit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(yesno <span class="sc">~</span> .,</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"knn"</span>,</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">preProcess =</span> <span class="st">"scale"</span>,</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">tuneLength =</span> <span class="dv">10</span>,</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">indexOut =</span> train_index)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Compare accuracy over all folds.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>resamps <span class="ot">&lt;-</span> <span class="fu">resamples</span>(<span class="fu">list</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>        <span class="at">CART =</span> rpartFit,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">kNearestNeighbors =</span> knnFit</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>        ))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(resamps)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.resamples(object = resamps)

Models: CART, kNearestNeighbors 
Number of resamples: 10 

Accuracy 
                   Min. 1st Qu. Median  Mean 3rd Qu.  Max. NA's
CART              0.867   0.878  0.886 0.886   0.897 0.905    0
kNearestNeighbors 0.873   0.884  0.887 0.888   0.891 0.905    0

Kappa 
                   Min. 1st Qu. Median  Mean 3rd Qu.  Max. NA's
CART              0.715   0.737  0.755 0.756   0.781 0.797    0
kNearestNeighbors 0.727   0.751  0.760 0.761   0.768 0.797    0</code></pre>
</div>
</div>
<p><code>caret</code> provides some visualizations using the package <code>lattice</code>. For example, a boxplot to compare the accuracy and kappa distribution (over the 10 folds).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lattice)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bwplot</span>(resamps, <span class="at">layout =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>########</p>
<p>We see that kNN is performing consistently better on the folds than CART (except for some outlier folds).</p>
<p>Find out if one models is statistically better than the other (is the difference in accuracy is not zero).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>difs <span class="ot">&lt;-</span> <span class="fu">diff</span>(resamps)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>difs</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
diff.resamples(x = resamps)

Models: CART, kNearestNeighbors 
Metrics: Accuracy, Kappa 
Number of differences: 1 
p-value adjustment: bonferroni </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(difs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
summary.diff.resamples(object = difs)

p-value adjustment: bonferroni 
Upper diagonal: estimates of the difference
Lower diagonal: p-value for H0: difference = 0

Accuracy 
                  CART  kNearestNeighbors
CART                    -0.00245         
kNearestNeighbors 0.579                  

Kappa 
                  CART  kNearestNeighbors
CART                    -0.00511         
kNearestNeighbors 0.595                  </code></pre>
</div>
</div>
<p>p-values tells you the probability of seeing an even more extreme value (difference between accuracy) given that the null hypothesis (difference = 0) is true. For a better classifier, the p-value should be less than .05 or 0.01. <code>diff</code> automatically applies Bonferroni correction for multiple comparisons. In this case, kNN seems better but the classifiers do not perform statistically differently.</p>
</section>
<section id="feature-selection-and-feature-preparation" class="level1">
<h1><strong>Feature Selection and Feature Preparation</strong></h1>
<p>Decision trees implicitly select features for splitting, but we can also select features manually.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(FSelector))</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">"FSelector"</span>)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(FSelector)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="univariate-feature-importance-score" class="level3">
<h3 class="anchored" data-anchor-id="univariate-feature-importance-score"><strong>Univariate Feature Importance Score</strong></h3>
<p>These scores measure how related each feature is to the class variable. For discrete features (as in our case), the chi-square statistic can be used to derive a score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>weights <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">chi.squared</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"feature"</span>) <span class="sc">|&gt;</span></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(attr_importance))</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>weights</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  feature attr_importance
  &lt;chr&gt;             &lt;dbl&gt;
1 bang              0.591
2 dollar            0.579
3 money             0.469
4 crl.tot           0.440
5 n000              0.425
6 make              0.265</code></pre>
</div>
</div>
<p>plot importance in descending order (using <code>reorder</code> to order factor levels used by <code>ggplot</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(weights,</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> attr_importance, <span class="at">y =</span> <span class="fu">reorder</span>(feature, attr_importance))) <span class="sc">+</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">"Importance score"</span>) <span class="sc">+</span> </span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Feature"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Get the 3 best features</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>subset <span class="ot">&lt;-</span> <span class="fu">cutoff.k</span>(weights <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>                   <span class="fu">column_to_rownames</span>(<span class="st">"feature"</span>), <span class="dv">3</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>subset</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "bang"   "dollar" "money" </code></pre>
</div>
</div>
<p>Use only the best 3 features to build a model (<code>Fselector</code> provides <code>as.simple.formula</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="fu">as.simple.formula</span>(subset, <span class="st">"yesno"</span>)</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>f</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>yesno ~ bang + dollar + money
&lt;environment: 0x1646af970&gt;</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">rpart</span>(f, <span class="at">data =</span> _)</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(m, <span class="at">extra =</span> <span class="dv">2</span>, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There are many alternative ways to calculate univariate importance scores (see package FSelector). Some of them (also) work for continuous features. One example is the information gain ratio based on entropy as used in decision tree induction.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>spam_train <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gain.ratio</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _) <span class="sc">|&gt;</span></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>(<span class="at">rownames =</span> <span class="st">"feature"</span>) <span class="sc">|&gt;</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(attr_importance))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  feature attr_importance
  &lt;chr&gt;             &lt;dbl&gt;
1 money            0.270 
2 n000             0.224 
3 dollar           0.206 
4 bang             0.159 
5 crl.tot          0.0715
6 make             0.0630</code></pre>
</div>
</div>
</section>
<section id="feature-subset-selection" class="level3">
<h3 class="anchored" data-anchor-id="feature-subset-selection"><strong>Feature Subset Selection</strong></h3>
<p>Often features are related and calculating importance for each feature independently is not optimal. We can use greedy search heuristics. For example <code>cfs</code> uses correlation/entropy with best first search.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>spam_train <span class="sc">|&gt;</span> </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cfs</span>(yesno <span class="sc">~</span> ., <span class="at">data =</span> _)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "dollar" "bang"   "money"  "n000"  </code></pre>
</div>
</div>
<p>Black-box feature selection uses an evaluator function (the black box) to calculate a score to be maximized. First, we define an evaluation function that builds a model given a subset of features and calculates a quality score. We use here the average for 5 bootstrap samples (<code>method = "cv"</code> can also be used instead), no tuning (to be faster), and the average accuracy as the score.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a>evaluator <span class="ot">&lt;-</span> <span class="cf">function</span>(subset) {</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a>  model <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">train</span>(<span class="fu">as.simple.formula</span>(subset, <span class="st">"yesno"</span>),</span>
<span id="cb90-4"><a href="#cb90-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">data =</span> _,</span>
<span id="cb90-5"><a href="#cb90-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb90-6"><a href="#cb90-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"boot"</span>, <span class="at">number =</span> <span class="dv">5</span>),</span>
<span id="cb90-7"><a href="#cb90-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">tuneLength =</span> <span class="dv">0</span>)</span>
<span id="cb90-8"><a href="#cb90-8" aria-hidden="true" tabindex="-1"></a>  results <span class="ot">&lt;-</span> model<span class="sc">$</span>resample<span class="sc">$</span>Accuracy</span>
<span id="cb90-9"><a href="#cb90-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Trying features:"</span>, <span class="fu">paste</span>(subset, <span class="at">collapse =</span> <span class="st">" + "</span>), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb90-10"><a href="#cb90-10" aria-hidden="true" tabindex="-1"></a>  m <span class="ot">&lt;-</span> <span class="fu">mean</span>(results)</span>
<span id="cb90-11"><a href="#cb90-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">"Accuracy:"</span>, <span class="fu">round</span>(m, <span class="dv">2</span>), <span class="st">"</span><span class="sc">\n\n</span><span class="st">"</span>)</span>
<span id="cb90-12"><a href="#cb90-12" aria-hidden="true" tabindex="-1"></a>  m</span>
<span id="cb90-13"><a href="#cb90-13" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Start with all features (but not the class variable <code>type</code>)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>features <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> <span class="fu">colnames</span>() <span class="sc">|&gt;</span> <span class="fu">setdiff</span>(<span class="st">"yesno"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>There are several (greedy) search strategies available. These run for a while!</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="do">##subset &lt;- backward.search(features, evaluator)</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="do">##subset &lt;- forward.search(features, evaluator)</span></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="do">##subset &lt;- best.first.search(features, evaluator)</span></span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a><span class="do">##subset &lt;- hill.climbing.search(features, evaluator)</span></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-6"><a href="#cb92-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Commenting these out for faster render time.</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="using-dummy-variables-for-factors" class="level3">
<h3 class="anchored" data-anchor-id="using-dummy-variables-for-factors"><strong>Using Dummy Variables for Factors</strong></h3>
<ul>
<li><p>Typically, a set of 0–1 dummy variables is used to encode nominal properties, also known as factors. For illustration, let’s attempt to determine whether an email has dollar($) sign based on whether it’s spam or not. First we use the original encoding of type as a factor with several values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>tree_dollar <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(dollar <span class="sc">~</span> yesno, <span class="at">data =</span> _)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(tree_dollar, <span class="at">extra =</span> <span class="dv">1</span>, <span class="at">roundint =</span> <span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>spam_train_dummy <span class="ot">&lt;-</span> <span class="fu">as_tibble</span>(<span class="fu">class2ind</span>(spam_train<span class="sc">$</span>yesno)) <span class="sc">|&gt;</span> </span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">everything</span>(), as.factor)) <span class="sc">|&gt;</span></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_column</span>(<span class="at">dollar =</span> spam_train<span class="sc">$</span>dollar)</span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a>spam_train_dummy</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3,682 × 3
   n     y     dollar
   &lt;fct&gt; &lt;fct&gt;  &lt;dbl&gt;
 1 0     1      0    
 2 0     1      0.18 
 3 0     1      0.184
 4 0     1      0    
 5 0     1      0    
 6 0     1      0    
 7 0     1      0.054
 8 0     1      0    
 9 0     1      0.081
10 0     1      0    
# ℹ 3,672 more rows</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>spam_dollar <span class="ot">&lt;-</span> spam_train_dummy <span class="sc">|&gt;</span> </span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rpart</span>(dollar <span class="sc">~</span> ., </span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _,</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>, <span class="at">cp =</span> <span class="fl">0.01</span>))</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(spam_dollar, <span class="at">roundint =</span> <span class="cn">FALSE</span>, <span class="at">box.palette =</span> <span class="st">"Blues"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> spam_train <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">train</span>(dollar <span class="sc">~</span> yesno, </span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>        <span class="at">data =</span> _, </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>        <span class="at">method =</span> <span class="st">"rpart"</span>,</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>        <span class="at">control =</span> <span class="fu">rpart.control</span>(<span class="at">minsplit =</span> <span class="dv">2</span>),</span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>        <span class="at">tuneGrid =</span> <span class="fu">data.frame</span>(<span class="at">cp =</span> <span class="fl">0.01</span>))</span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>fit</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>CART 

3682 samples
   1 predictor

No pre-processing
Resampling: Bootstrapped (25 reps) 
Summary of sample sizes: 3682, 3682, 3682, 3682, 3682, 3682, ... 
Resampling results:

  RMSE   Rsquared  MAE   
  0.229  0.107     0.0815

Tuning parameter 'cp' was held constant at a value of 0.01</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rpart.plot</span>(fit<span class="sc">$</span>finalModel, <span class="at">extra =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
</div></li>
</ul>
</section>
</section>
<section id="class-imbalance" class="level1">
<h1><strong>Class Imbalance</strong></h1>
<p>Classifiers have a hard time to learn from data where we have much more observations for one class (called the majority class). This is called the class imbalance problem.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart)</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rpart.plot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Class Distribution</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(spam, <span class="fu">aes</span>(<span class="at">y =</span> yesno)) <span class="sc">+</span> <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="hw03-1_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Since this is a binary classification problem, and the dataset clearly isn’t massively imbalanced, it is impractical to apply class balancing techniques.</p>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>